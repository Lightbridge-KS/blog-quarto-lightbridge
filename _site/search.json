[
  {
    "objectID": "license.html",
    "href": "license.html",
    "title": "License",
    "section": "",
    "text": "My blog posts are released under a Creative Commons Attribution-ShareAlike 4.0 International License.\n© r format(Sys.Date(), format = \"%Y\") Lightbridge"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "My Blog",
    "section": "",
    "text": "Linear Model Subset Selection\n\n\nA Tidy Approach\n\n\n\n\nR\n\n\nStats\n\n\nML\n\n\n\n\nVariable selection for linear model using best subset selection\n\n\n\n\n\n\nSep 27, 2023\n\n\nKittipos Sirivongrungson\n\n\n\n\n\n\n  \n\n\n\n\nPredicting Credit Card Default Status\n\n\nA Logistic Regression Model using R.\n\n\n\n\nR\n\n\nStats\n\n\nML\n\n\n\n\nPlaying with logistic regression model with Default dataset\n\n\n\n\n\n\nMay 4, 2022\n\n\nKittipos Sirivongrungson\n\n\n\n\n\n\n  \n\n\n\n\nTIMI Risk Score for STEMI\n\n\nA Simple Calculator\n\n\n\n\nR\n\n\nMed\n\n\nCalculator\n\n\n\n\nHow to program a simple TIMI risk score calculator for STEMI\n\n\n\n\n\n\nMay 3, 2022\n\n\nKittipos Sirivongrungson\n\n\n\n\n\n\n  \n\n\n\n\nLinear Regression Models\n\n\n\n\n\n\n\nR\n\n\nStats\n\n\nPenguins\n\n\n\n\nLinear models with palmerpenguins\n\n\n\n\n\n\nApr 3, 2022\n\n\nKittipos Sirivongrungson\n\n\n\n\n\n\n  \n\n\n\n\nOpen and Create R project from Shell\n\n\n\n\n\n\n\nR\n\n\nShell\n\n\nFun-Idea\n\n\n\n\nA fun tutorial involving zsh & R code\n\n\n\n\n\n\nMar 17, 2022\n\n\nKittipos Sirivongrungson\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2022-03-17-shell-to-r-1/index.html",
    "href": "posts/2022-03-17-shell-to-r-1/index.html",
    "title": "Open and Create R project from Shell",
    "section": "",
    "text": "I am an R user who know a little bit of linux shell, one day I wonder…\nThis blog post will show you how to do that and hopefully you’ll learn something new and enjoy using it!\nWhat you’ll need\nIn the next demonstraction, I’ll walk you through by creating a shell function which you have to store it in ~/.bashrc or ~/.zshrc (or other locations that can be sourced) by yourself.\nBefore I started, I using macOs, and my shell is zsh running in a Terminal app. If you are using different shell, modify the code correspondingly.\nCode\n$SHELL --version\n\n\nzsh 5.8 (x86_64-apple-darwin21.0)"
  },
  {
    "objectID": "posts/2022-03-17-shell-to-r-1/index.html#quick-navigation",
    "href": "posts/2022-03-17-shell-to-r-1/index.html#quick-navigation",
    "title": "Open and Create R project from Shell",
    "section": "Quick Navigation",
    "text": "Quick Navigation\nHow to navigate to an R project quickly ? Lots of options can do it without using a mouse, e.g. using Spotlight Search in mac, but to day I’ll use command line.\nI like to group most of my R projects in a single directory (i.e. R_programming) so that I can navigate easily even with GUI. That will helpful when using CLI too.\nYou might already know cd command which change directory of a terminal, but typing cd multiple times can be time consuming.\n\nA simple solution is to creating a shell function to change directory to a parent folder which contains R projects.\n\n\n\nCode\n# Define a function to change directory\ncdrpg(){\n    cd \"/Users/kittipos/Desktop/R_Programming\"\n}\n\n# Call function to change directory to `R_Programming/`\ncdrpg\n\n# Print working directory\npwd\n\n\n/Users/kittipos/Desktop/R_Programming\n\n\nIn the code above.1\n\nI define a shell function cdrpg() that change directory to my R_programming folder\nI execute cdrpg, and the directory is then changed (to call function in shell, you don’t use parenthesis).\nCall pwd to confirm the location at R_Programming directory\n\nFor me, I store this function in a .zsh file that can be sourced by ~/.zshrc\ncd-to.zsh\n#!/bin/zsh\n\n# CD to R_Programming Folder\ncdrpg(){\n    cd \"/Users/kittipos/Desktop/R_Programming\"\n}\nAnd, make it executable by:\nchmod +x \"cd-to.zsh\"\nSo that every time I open shell, I could call cdrpg, and I would arriving at R_Programming directory.\nAnd I also define similar functions to cd to other frequently-visited locations in this cd-to.zsh script as well."
  },
  {
    "objectID": "posts/2022-03-17-shell-to-r-1/index.html#open-r-project",
    "href": "posts/2022-03-17-shell-to-r-1/index.html#open-r-project",
    "title": "Open and Create R project from Shell",
    "section": "Open R project",
    "text": "Open R project\nAfter I’ve arrived at R_Programming/ and cd to the sub-directory I wanted, I can open R project from shell with the following command\nopen *.Rproj\nThe result is similar to clicking .Rproj icon to open an RStudio project.\nTo save typing, I wrap this into openrpg() function and store it in a shell script which can be sourced by ~/.zshrc\nr-proj.zsh\n#!/bin/zsh\n# A function to open R project in current directory\nopenrpg(){\n    open *.Rproj\n}\nAnd, make it executable by:\nchmod +x \"r-proj.zsh\""
  },
  {
    "objectID": "posts/2022-03-17-shell-to-r-1/index.html#using-radian-console",
    "href": "posts/2022-03-17-shell-to-r-1/index.html#using-radian-console",
    "title": "Open and Create R project from Shell",
    "section": "Using Radian Console",
    "text": "Using Radian Console\nThe radian is a modern R console in the shell. First, enter R by running radian, then type any R code. The result looks pretty.\n\nTo create a new project, you can use usethis::create_project(\"path-to-project\")\n\nIt’s done!, however, there is quite a bit of typing.\nNext, I’ll show you to all of this plus open an R project being created all in one line of code with fewer characters."
  },
  {
    "objectID": "posts/2022-03-17-shell-to-r-1/index.html#create-r-project-directly-from-shell",
    "href": "posts/2022-03-17-shell-to-r-1/index.html#create-r-project-directly-from-shell",
    "title": "Open and Create R project from Shell",
    "section": "Create R Project directly from Shell",
    "text": "Create R Project directly from Shell\n\nThe Goal\nWhat I want to achieve is this…\nIf I run this command in shell,\nnewrpj \"foo\"\nthe R project “foo” should be created, then in my terminal it should cd to foo/ directory, and open foo.Rproj file in RStudio.\nWe’ll need to do a couple of things:\n\nExecute that R script from Shell, and also passing R project name as shell argument.\nPut all necessary R functions in an R script. I’ll call it new-rpj.R\nWrap all shell commands into one shell function\n\n\n\nExecute R Script from Shell\nCommand Line Basics for R Users show that Rscript command is the way to execute R script from shell.\nThe basic usage is quite simple.\nRscript \"/Users/kittipos/bin-ks/helper/R/new-rpg.R\" \"foo\"\nThis will execute new-rpj.R, and “foo” is a shell argument to be passed to the script.\n\n\nWrite R Script\nNow, let’s edit new-rpj.R\nnew-rpj.R\n# Retrieve Shell arguments\narg &lt;- commandArgs(trailingOnly = TRUE)[1]\n\n# Show what parameter is being recieved\ncat(\"- Passing zsh parameter:\", arg)\n\n# Create R Project using name we've supply\nusethis::create_project(arg, rstudio = TRUE)\n\ncommandArgs() is a function to retrieve shell arguments, trailingOnly = TRUE will only get the one that we’ve supply, for more example see r-bloggers post.\nAssign the first shell argument to arg\ncat() to confirm the passing parameter.\nLastly, usethis::create_project() to create an R project with name from arg. Use rstudio = TRUE to also create .Rproj file.\n\nAfter saving this script new-rpg.R, try running this in the shell:\nRscript \"/Users/kittipos/bin-ks/helper/R/new-rpg.R\" \"foo\"\nIt should create R project “foo” as a sub-directory of your current working directory.\n\n\nWrap up everything\nFinally, let’s wrap-up everything by building newrpj function to create R project, change directory to the project folder, and open the project in RStudio.\nI store this function in r-proj.zsh which can be sourced by ~/.zshrc.\nr-proj.zsh\n#!/bin/zsh\n## Function to create new R Project, `cd` to the project, and open in RStudio\nnewrpj(){\n    # Create R project in a sub-directory with names from shell 1st argument\n    Rscript \"/Users/kittipos/bin-ks/helper/R/new-rpj.R\" \"$1\"\n    # Go into that sub-directory & Open R project in RStudio\n    cd \"$1\"\n    open *.Rproj\n}\n\nNotice $1 which is a shell variable that represents the first argument supplies to the newrpj() function, which, in this case, is an R project name.\n\nHere is the result of calling newrpj with argument “tester”\n\nCreated RStudio project named “tester”\nChange working directory to tester, and\nOpen RStudio"
  },
  {
    "objectID": "posts/2022-03-17-shell-to-r-1/index.html#footnotes",
    "href": "posts/2022-03-17-shell-to-r-1/index.html#footnotes",
    "title": "Open and Create R project from Shell",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nYou can also define an alias instead of function, but I like to use function because It can handle larger code better. Also, another way is to assign path to a $VARIABLE and cd $VARIABLE, but you might have to type more characters.↩︎"
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html",
    "href": "posts/2022-04-03_lm-penguins/index.html",
    "title": "Linear Regression Models",
    "section": "",
    "text": "Let’s explore linear regression models. The data I will be using is penguins dataset from palmerpenguins package [1].\nCode\nlibrary(tidyverse)\nlibrary(palmerpenguins)"
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#plotting",
    "href": "posts/2022-04-03_lm-penguins/index.html#plotting",
    "title": "Linear Regression Models",
    "section": "Plotting",
    "text": "Plotting\nNow, Let’s visualize a scatter plot between these 2 variables.\n\n\nCode\np1 &lt;- penguins %&gt;% \n  ggplot(aes(bill_depth_mm, body_mass_g)) +\n  geom_point(color = \"cyan4\", alpha = 0.7) +\n  geom_smooth(method = \"lm\") +\n  labs(title = \"Simple Linear Regression\")\n\np1\n\n\n\n\n\nFigure 1: Points represent each observations. Blue line is a simple linear regression fitted to the data.\n\n\n\n\nFigure 1 show relationships between body_mass_g and bill_depth_mm. Looking at these points, I can see 2 clouds of points: the upper-left group and the lower-right group.\nBy looking at the line, something strange is happening here, the line connects 2 clouds of points together with downward sloping; an increase in bill_depth_mm corresponding to a decrease of body_mass_g !\nIt’s a little weird right ?\nI will explore this further, but for now let’s assume that it is OK and continue to fit the model."
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#fitting-model",
    "href": "posts/2022-04-03_lm-penguins/index.html#fitting-model",
    "title": "Linear Regression Models",
    "section": "Fitting Model",
    "text": "Fitting Model\nI will use lm() function to fit the model, then the model’s summary will be shown by summary().\n\n\nCode\npen_lm_fit_simple &lt;- lm(body_mass_g ~ bill_depth_mm, data = penguins)\nsummary(pen_lm_fit_simple)\n#&gt; \n#&gt; Call:\n#&gt; lm(formula = body_mass_g ~ bill_depth_mm, data = penguins)\n#&gt; \n#&gt; Residuals:\n#&gt;      Min       1Q   Median       3Q      Max \n#&gt; -1607.38  -510.10   -66.96   462.43  1819.28 \n#&gt; \n#&gt; Coefficients:\n#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    \n#&gt; (Intercept)    7488.65     335.22   22.34   &lt;2e-16 ***\n#&gt; bill_depth_mm  -191.64      19.42   -9.87   &lt;2e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Residual standard error: 708.1 on 340 degrees of freedom\n#&gt;   (2 observations deleted due to missingness)\n#&gt; Multiple R-squared:  0.2227, Adjusted R-squared:  0.2204 \n#&gt; F-statistic: 97.41 on 1 and 340 DF,  p-value: &lt; 2.2e-16\n\n\nbroom::glance() will return model’s summary in a one-row tibble which can be easier to manipulate it later.\n\n\nCode\nbroom::glance(pen_lm_fit_simple)\n\n\n\n\n\n\nr.squared\nadj.r.squared\nsigma\nstatistic\np.value\ndf\nlogLik\nAIC\nBIC\ndeviance\ndf.residual\nnobs\n\n\n\n\n0.2227044\n0.2204182\n708.0772\n97.414\n0\n1\n-2728.667\n5463.334\n5474.839\n170466918\n340\n342"
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#summary",
    "href": "posts/2022-04-03_lm-penguins/index.html#summary",
    "title": "Linear Regression Models",
    "section": "Summary",
    "text": "Summary\n\n\n\n\n\n\nModel Summary\n\n\n\nThe linear regression model of body_mass_g on bill_depth_mm has an adjusted R2 = 0.22, p-value &lt; 0.001; meaning that this model is statistically significant and 22% of variation in body_mass_g can be explained by bill_depth_mm.\n\n\nAutomated Report\n\nCode\nreport::report(pen_lm_fit_simple)  %&gt;% summary() \n\nWe fitted a linear model to predict body_mass_g with bill_depth_mm. The model’s explanatory power is moderate (R2 = 0.22, adj. R2 = 0.22). The model’s intercept is at 7488.65 (95% CI [6829.29, 8148.01]). Within this model:\n\nThe effect of bill depth mm is statistically significant and negative (beta = -191.64, 95% CI [-229.84, -153.45], t(340) = -9.87, p &lt; .001, Std. beta = -0.47)"
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#coefficient",
    "href": "posts/2022-04-03_lm-penguins/index.html#coefficient",
    "title": "Linear Regression Models",
    "section": "Coefficient",
    "text": "Coefficient\nThe estimated model coefficients can be written as Equation 1.\n\\[\n\\widehat{Wt} = 7488.7 - 191.6 \\times Bill.Depth\n\\tag{1}\\]\n\n\n\n\n\n\nCoefficient Interpretation\n\n\n\nEvery 1 mm increases in bill depth corresponds to an estimated decreases of weight by -191.6 kg."
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#plotting-1",
    "href": "posts/2022-04-03_lm-penguins/index.html#plotting-1",
    "title": "Linear Regression Models",
    "section": "Plotting",
    "text": "Plotting\nLet’s make a scatter plot similar to Figure 1 with colors added to species.\n\n\nCode\np2 &lt;- penguins %&gt;% \n  ggplot(aes(bill_depth_mm, body_mass_g, color = species, shape = species)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  scale_color_brewer(palette = \"Set2\") +\n  labs(title = \"Multiple Linear Regression\")\n\np2\n\n\n\n\n\nFigure 2: 3 linear regressions by each species\n\n\n\n\nIn Figure 2, with color = species added to the plot, we can see that the upper-left cloud of points are Gentoo species and the lower-right are Adelie and Chinstrap. The interesting thing here is the 3 regression lines that fitted to each species has an upward slope which is contrast to the Figure 1.\n\n\n\n\n\n\nCompare Plots\n\n\n\nYou can see the plots of simple vs multiple linear regression side-by-side here."
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#fitting-model-1",
    "href": "posts/2022-04-03_lm-penguins/index.html#fitting-model-1",
    "title": "Linear Regression Models",
    "section": "Fitting Model",
    "text": "Fitting Model\nNext, The model will be fitted once again with an outcome variable: body_mass_g , and predictors: bill_depth_mm and species. I will use broom::tidy() to show model coefficients.\n\n\nCode\npen_lm_fit_multi &lt;- lm(body_mass_g ~ bill_depth_mm + species, data = penguins)\n\nbroom::tidy(pen_lm_fit_multi)\n\n\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n-1007.28112\n323.56097\n-3.1131107\n0.0020093\n\n\nbill_depth_mm\n256.61461\n17.56282\n14.6112380\n0.0000000\n\n\nspeciesChinstrap\n13.37732\n52.94712\n0.2526544\n0.8006889\n\n\nspeciesGentoo\n2238.66811\n73.68183\n30.3829071\n0.0000000\n\n\n\n\n\n\nbroom::glance() shows model overview as one-row data frame.\n\n\nCode\nbroom::glance(pen_lm_fit_multi)\n\n\n\n\n\n\nr.squared\nadj.r.squared\nsigma\nstatistic\np.value\ndf\nlogLik\nAIC\nBIC\ndeviance\ndf.residual\nnobs\n\n\n\n\n0.7975462\n0.7957493\n362.4362\n443.839\n0\n3\n-2498.619\n5007.239\n5026.413\n44399670\n338\n342"
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#summary-1",
    "href": "posts/2022-04-03_lm-penguins/index.html#summary-1",
    "title": "Linear Regression Models",
    "section": "Summary",
    "text": "Summary\n\n\n\n\n\n\nModel Summary\n\n\n\nThe linear regression model of body_mass_g on bill_depth_mm and species has an adjusted R2 = 0.8, p-value &lt; 0.001; meaning that this model is statistically significant and 22% of variation in body_mass_g can be explained by bill_depth_mm and species.\n\n\nAutomated Report\n\nCode\nreport::report(pen_lm_fit_multi)  %&gt;% summary() \n\nWe fitted a linear model to predict body_mass_g with bill_depth_mm and species. The model’s explanatory power is substantial (R2 = 0.80, adj. R2 = 0.80). The model’s intercept is at -1007.28 (95% CI [-1643.73, -370.83]). Within this model:\n\nThe effect of bill depth mm is statistically significant and positive (beta = 256.61, 95% CI [222.07, 291.16], t(338) = 14.61, p &lt; .001, Std. beta = 0.63)\nThe effect of species [Chinstrap] is statistically non-significant and positive (beta = 13.38, 95% CI [-90.77, 117.52], t(338) = 0.25, p = 0.801, Std. beta = 0.02)\nThe effect of species [Gentoo] is statistically significant and positive (beta = 2238.67, 95% CI [2093.74, 2383.60], t(338) = 30.38, p &lt; .001, Std. beta = 2.79)"
  },
  {
    "objectID": "posts/2022-04-03_lm-penguins/index.html#coefficient-1",
    "href": "posts/2022-04-03_lm-penguins/index.html#coefficient-1",
    "title": "Linear Regression Models",
    "section": "Coefficient",
    "text": "Coefficient\nThe estimated model coefficients can be written as Equation 2.\n\\[\n\\begin{aligned}\n\\widehat{Wt} = &- 1007.3 \\\\\n               &+ 256.6 \\times Bill.Depth \\\\\n               &+ 13.4 \\times SP_{Chinstrap} \\\\\n               &+ 2238.7 \\times SP_{Gentoo}\n\\end{aligned}\n\\tag{2}\\]\nI use the notation \\(Var_{LV}\\) to represent indicator variables for when the categorical variable takes a particular value. For example \\(SP_{Chinstrap}\\) would take a value of 1 if the species is “Chinstrap”, and it would take a value of 0 otherwise. The same logic also applies to “Gentoo”.\nWe have seen from the Figure 2 that the models can be visualized as 3 regression lines for each species. Now we shall see whether coefficient of the model agree with the plot.\n\nSlope\nThe slope of the line is the coefficient of \\(Bill.Depth\\) as given by Equation 2, It means that the slope of each 3 lines is the same (= 256.6).\n\n\n\n\n\n\nSlope Interpretation\n\n\n\nFor every 1 mm increases in bill_depth_mm in any given species corresponds to an estimated increases in body_mass_g of 256.6.\n\n\n\n\n\n\n\n\nImportant\n\n\n\nIn this multiple regression example, It can be seen that the coefficient of bill_depth_mm after adjusting for species (256.6) is not the same as before when it is the only predictor (-191.6).\n\n\n\n\nDistances between Lines\nWe can estimate differences in body_mass_g among species when taking bill_depth_mm into account using Equation 2. The “Adelie” species is considered as baseline.\nFor example, using \\(SP_{Gentoo}\\) coefficient, we could say that “Gentoo” has an estimated weight of 2238.7 (g) more than “Adelie” for any given bill_depth_mm. Note that the effect of “Chinstrap” is non-significant as we can already see in the Figure 2 that Chinstrap’s line and Adelie’s line are, in fact, very close."
  },
  {
    "objectID": "posts/2022-05-03_med-calc-timi/index.html",
    "href": "posts/2022-05-03_med-calc-timi/index.html",
    "title": "TIMI Risk Score for STEMI",
    "section": "",
    "text": "Today, I build a simple program to calculate TIMI Risk Score for STEMI [1] using R code.\nThe calculator will simply base on this table chart.\nCode\nlibrary(tidyverse)\ntheme_set(theme_bw())"
  },
  {
    "objectID": "posts/2022-05-03_med-calc-timi/index.html#main-function-timi_calc",
    "href": "posts/2022-05-03_med-calc-timi/index.html#main-function-timi_calc",
    "title": "TIMI Risk Score for STEMI",
    "section": "Main Function: TIMI_calc()",
    "text": "Main Function: TIMI_calc()\nFunction’s Parameter\nHistorical\n\nage: (int) Age in years\nDM: (lgl) Any DM ?\nHTN: (lgl) Any HTN ?\nangina: (lgl) Any angina ?\n\nExam\n\nSBP: (dbl) Systolic Blood Pressure (mmHg)\nHR: (dbl) Heart Rate (bpm)\nKillip: (lgl) Killip Class form 1 - 4\nwt: (dbl) Weight in kg\n\nPresentation\n\nAnt_STE: (lgl) Anterior STE ?\nLBBB: (lgl) LBBB ?\ntime_to_rx: (dbl) time to treatment (hr)\n\nReturn value: A data frame with 3 columns:\n\nrisk.score: TIMI risk score\nodds.death.30d: estimated odds of death by 30 day.\np.death.30d: estimated probability of death by 30 day."
  },
  {
    "objectID": "posts/2022-05-03_med-calc-timi/index.html#helper-function",
    "href": "posts/2022-05-03_med-calc-timi/index.html#helper-function",
    "title": "TIMI Risk Score for STEMI",
    "section": "Helper Function",
    "text": "Helper Function\nSince the original table reports as odds not a probability of death by 30 day. We need to write a function to convert odds to probability.\nOdds of death is a ratio of the probability of death to the probability of survival; we can write the Equation 1 (\\(p\\) denotes the probability of death).\n\\[\nodd = \\frac{p}{1-p}\n\\tag{1}\\]\nRearranging terms \\(p\\) to the left, we get:\n\\[\np = \\frac{odd}{odd + 1}\n\\]\nTherefore we can write function odds_to_prob().\n\n\nCode\nodds_to_prob &lt;- function(odds) odds / (odds + 1)"
  },
  {
    "objectID": "posts/2022-05-03_med-calc-timi/index.html#lookup-table",
    "href": "posts/2022-05-03_med-calc-timi/index.html#lookup-table",
    "title": "TIMI Risk Score for STEMI",
    "section": "Lookup Table",
    "text": "Lookup Table\nrisk_df is a lookup table that maps risk score to the odds and probability of death.\n\n\nCode\nrisk_df &lt;- tibble::tibble(\n  risk.score = 0:8,\n  odds.death.30d = c(0.1, 0.3, 0.4, 0.7, 1.2, 2.2, 3, 4.8, 5.8)\n  ) %&gt;% \n  # Test Convert Odds to Probability\n  mutate(p.death.30d = odds_to_prob(odds.death.30d))\n\nrisk_df\n\n\n\n\n\n\nrisk.score\nodds.death.30d\np.death.30d\n\n\n\n\n0\n0.1\n0.0909091\n\n\n1\n0.3\n0.2307692\n\n\n2\n0.4\n0.2857143\n\n\n3\n0.7\n0.4117647\n\n\n4\n1.2\n0.5454545\n\n\n5\n2.2\n0.6875000\n\n\n6\n3.0\n0.7500000\n\n\n7\n4.8\n0.8275862\n\n\n8\n5.8\n0.8529412\n\n\n\n\n\n\n\n\nCode\nrisk_df %&gt;% \n  ggplot(aes(risk.score, p.death.30d, color = risk.score)) +\n  geom_point(alpha = 0.8, size = 3, show.legend = F) +\n  geom_smooth(se = FALSE, size = 0.5, lty = \"dashed\", show.legend = F) +\n  scale_color_viridis_c(option = \"plasma\", \n                        begin = 0.1,end = 0.8) +\n  labs(x = \"TIMI risk score\", y = \"Probability of death (30d)\")\n\n\n\n\n\n\n\n\n\nKeep in mind that if risk score is &gt; 8, the odds of death by 30 day would be 8.8 but this would be impossible to include in the data frame."
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html",
    "href": "posts/2023-09-27_lm-subset-select/index.html",
    "title": "Linear Model Subset Selection",
    "section": "",
    "text": "An example to perform variable selection using best subset selection method for a linear regression model in R by implementing: tidy-styled functions.\nThis is a repost from R-Pub.\nCode\nlibrary(tidyverse)\nlibrary(ISLR2) # For Dataset\nlibrary(leaps)\n\ntheme_set(theme_bw())"
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html#missing-values",
    "href": "posts/2023-09-27_lm-subset-select/index.html#missing-values",
    "title": "Linear Model Subset Selection",
    "section": "Missing Values",
    "text": "Missing Values\nLet’s remove rows containg missing values.\n\n\nCode\nvisdat::vis_miss(Hitters)\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the visdat package.\n  Please report the issue at &lt;https://github.com/ropensci/visdat/issues&gt;.\n\n\n\n\n\n\n\nCode\nHitters &lt;- Hitters %&gt;% na.omit()\n\nsum(is.na(Hitters$Salary))\n\n\n[1] 0"
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html#best-subset-selection-method",
    "href": "posts/2023-09-27_lm-subset-select/index.html#best-subset-selection-method",
    "title": "Linear Model Subset Selection",
    "section": "Best Subset Selection Method",
    "text": "Best Subset Selection Method\n\n\nCode\nregfit.full &lt;- leaps::regsubsets(Salary ~ ., Hitters)\nsummary(regfit.full)\n\n\nSubset selection object\nCall: regsubsets.formula(Salary ~ ., Hitters)\n19 Variables  (and intercept)\n           Forced in Forced out\nAtBat          FALSE      FALSE\nHits           FALSE      FALSE\nHmRun          FALSE      FALSE\nRuns           FALSE      FALSE\nRBI            FALSE      FALSE\nWalks          FALSE      FALSE\nYears          FALSE      FALSE\nCAtBat         FALSE      FALSE\nCHits          FALSE      FALSE\nCHmRun         FALSE      FALSE\nCRuns          FALSE      FALSE\nCRBI           FALSE      FALSE\nCWalks         FALSE      FALSE\nLeagueN        FALSE      FALSE\nDivisionW      FALSE      FALSE\nPutOuts        FALSE      FALSE\nAssists        FALSE      FALSE\nErrors         FALSE      FALSE\nNewLeagueN     FALSE      FALSE\n1 subsets of each size up to 8\nSelection Algorithm: exhaustive\n         AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI\n1  ( 1 ) \" \"   \" \"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n2  ( 1 ) \" \"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n3  ( 1 ) \" \"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n4  ( 1 ) \" \"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n5  ( 1 ) \"*\"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n6  ( 1 ) \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n7  ( 1 ) \" \"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \"*\"    \"*\"   \"*\"    \" \"   \" \" \n8  ( 1 ) \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \" \"    \" \"   \"*\"    \"*\"   \" \" \n         CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN\n1  ( 1 ) \" \"    \" \"     \" \"       \" \"     \" \"     \" \"    \" \"       \n2  ( 1 ) \" \"    \" \"     \" \"       \" \"     \" \"     \" \"    \" \"       \n3  ( 1 ) \" \"    \" \"     \" \"       \"*\"     \" \"     \" \"    \" \"       \n4  ( 1 ) \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n5  ( 1 ) \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n6  ( 1 ) \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n7  ( 1 ) \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n8  ( 1 ) \"*\"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n\n\nTry to include all predictors; I will increase nvmax.\n\n\nCode\nregfit.full &lt;- regsubsets(Salary ~ ., data = Hitters,\n    nvmax = 19)\nreg.summary &lt;- summary(regfit.full)\nreg.summary \n\n\nSubset selection object\nCall: regsubsets.formula(Salary ~ ., data = Hitters, nvmax = 19)\n19 Variables  (and intercept)\n           Forced in Forced out\nAtBat          FALSE      FALSE\nHits           FALSE      FALSE\nHmRun          FALSE      FALSE\nRuns           FALSE      FALSE\nRBI            FALSE      FALSE\nWalks          FALSE      FALSE\nYears          FALSE      FALSE\nCAtBat         FALSE      FALSE\nCHits          FALSE      FALSE\nCHmRun         FALSE      FALSE\nCRuns          FALSE      FALSE\nCRBI           FALSE      FALSE\nCWalks         FALSE      FALSE\nLeagueN        FALSE      FALSE\nDivisionW      FALSE      FALSE\nPutOuts        FALSE      FALSE\nAssists        FALSE      FALSE\nErrors         FALSE      FALSE\nNewLeagueN     FALSE      FALSE\n1 subsets of each size up to 19\nSelection Algorithm: exhaustive\n          AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI\n1  ( 1 )  \" \"   \" \"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n2  ( 1 )  \" \"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n3  ( 1 )  \" \"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n4  ( 1 )  \" \"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n5  ( 1 )  \"*\"   \"*\"  \" \"   \" \"  \" \" \" \"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n6  ( 1 )  \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \" \"    \" \"   \" \"    \" \"   \"*\" \n7  ( 1 )  \" \"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \"*\"    \"*\"   \"*\"    \" \"   \" \" \n8  ( 1 )  \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \" \"    \" \"   \"*\"    \"*\"   \" \" \n9  ( 1 )  \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \"*\"    \" \"   \" \"    \"*\"   \"*\" \n10  ( 1 ) \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \"*\"    \" \"   \" \"    \"*\"   \"*\" \n11  ( 1 ) \"*\"   \"*\"  \" \"   \" \"  \" \" \"*\"   \" \"   \"*\"    \" \"   \" \"    \"*\"   \"*\" \n12  ( 1 ) \"*\"   \"*\"  \" \"   \"*\"  \" \" \"*\"   \" \"   \"*\"    \" \"   \" \"    \"*\"   \"*\" \n13  ( 1 ) \"*\"   \"*\"  \" \"   \"*\"  \" \" \"*\"   \" \"   \"*\"    \" \"   \" \"    \"*\"   \"*\" \n14  ( 1 ) \"*\"   \"*\"  \"*\"   \"*\"  \" \" \"*\"   \" \"   \"*\"    \" \"   \" \"    \"*\"   \"*\" \n15  ( 1 ) \"*\"   \"*\"  \"*\"   \"*\"  \" \" \"*\"   \" \"   \"*\"    \"*\"   \" \"    \"*\"   \"*\" \n16  ( 1 ) \"*\"   \"*\"  \"*\"   \"*\"  \"*\" \"*\"   \" \"   \"*\"    \"*\"   \" \"    \"*\"   \"*\" \n17  ( 1 ) \"*\"   \"*\"  \"*\"   \"*\"  \"*\" \"*\"   \" \"   \"*\"    \"*\"   \" \"    \"*\"   \"*\" \n18  ( 1 ) \"*\"   \"*\"  \"*\"   \"*\"  \"*\" \"*\"   \"*\"   \"*\"    \"*\"   \" \"    \"*\"   \"*\" \n19  ( 1 ) \"*\"   \"*\"  \"*\"   \"*\"  \"*\" \"*\"   \"*\"   \"*\"    \"*\"   \"*\"    \"*\"   \"*\" \n          CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN\n1  ( 1 )  \" \"    \" \"     \" \"       \" \"     \" \"     \" \"    \" \"       \n2  ( 1 )  \" \"    \" \"     \" \"       \" \"     \" \"     \" \"    \" \"       \n3  ( 1 )  \" \"    \" \"     \" \"       \"*\"     \" \"     \" \"    \" \"       \n4  ( 1 )  \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n5  ( 1 )  \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n6  ( 1 )  \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n7  ( 1 )  \" \"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n8  ( 1 )  \"*\"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n9  ( 1 )  \"*\"    \" \"     \"*\"       \"*\"     \" \"     \" \"    \" \"       \n10  ( 1 ) \"*\"    \" \"     \"*\"       \"*\"     \"*\"     \" \"    \" \"       \n11  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \" \"    \" \"       \n12  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \" \"    \" \"       \n13  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \" \"       \n14  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \" \"       \n15  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \" \"       \n16  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \" \"       \n17  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \"*\"       \n18  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \"*\"       \n19  ( 1 ) \"*\"    \"*\"     \"*\"       \"*\"     \"*\"     \"*\"    \"*\"       \n\n\nWe can use plot() to show predictors included at each Cp, BIC, or Adjusted R-squared.\n\n\nCode\nplot(regfit.full, scale = \"Cp\")"
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html#using-cp-bic-adjusted-r-squared",
    "href": "posts/2023-09-27_lm-subset-select/index.html#using-cp-bic-adjusted-r-squared",
    "title": "Linear Model Subset Selection",
    "section": "Using Cp, BIC, Adjusted R Squared",
    "text": "Using Cp, BIC, Adjusted R Squared\nbroom::tidy() can also be used in regsubsets class\n\n\nCode\nregfit_tidy &lt;- broom::tidy(regfit.full)\nregfit_tidy \n\n\n# A tibble: 19 × 24\n   `(Intercept)` AtBat Hits  HmRun Runs  RBI   Walks Years CAtBat CHits CHmRun\n   &lt;lgl&gt;         &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;  &lt;lgl&gt; &lt;lgl&gt; \n 1 TRUE          FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  FALSE FALSE \n 2 TRUE          FALSE TRUE  FALSE FALSE FALSE FALSE FALSE FALSE  FALSE FALSE \n 3 TRUE          FALSE TRUE  FALSE FALSE FALSE FALSE FALSE FALSE  FALSE FALSE \n 4 TRUE          FALSE TRUE  FALSE FALSE FALSE FALSE FALSE FALSE  FALSE FALSE \n 5 TRUE          TRUE  TRUE  FALSE FALSE FALSE FALSE FALSE FALSE  FALSE FALSE \n 6 TRUE          TRUE  TRUE  FALSE FALSE FALSE TRUE  FALSE FALSE  FALSE FALSE \n 7 TRUE          FALSE TRUE  FALSE FALSE FALSE TRUE  FALSE TRUE   TRUE  TRUE  \n 8 TRUE          TRUE  TRUE  FALSE FALSE FALSE TRUE  FALSE FALSE  FALSE TRUE  \n 9 TRUE          TRUE  TRUE  FALSE FALSE FALSE TRUE  FALSE TRUE   FALSE FALSE \n10 TRUE          TRUE  TRUE  FALSE FALSE FALSE TRUE  FALSE TRUE   FALSE FALSE \n11 TRUE          TRUE  TRUE  FALSE FALSE FALSE TRUE  FALSE TRUE   FALSE FALSE \n12 TRUE          TRUE  TRUE  FALSE TRUE  FALSE TRUE  FALSE TRUE   FALSE FALSE \n13 TRUE          TRUE  TRUE  FALSE TRUE  FALSE TRUE  FALSE TRUE   FALSE FALSE \n14 TRUE          TRUE  TRUE  TRUE  TRUE  FALSE TRUE  FALSE TRUE   FALSE FALSE \n15 TRUE          TRUE  TRUE  TRUE  TRUE  FALSE TRUE  FALSE TRUE   TRUE  FALSE \n16 TRUE          TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  FALSE TRUE   TRUE  FALSE \n17 TRUE          TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  FALSE TRUE   TRUE  FALSE \n18 TRUE          TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE   TRUE  FALSE \n19 TRUE          TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE   TRUE  TRUE  \n# ℹ 13 more variables: CRuns &lt;lgl&gt;, CRBI &lt;lgl&gt;, CWalks &lt;lgl&gt;, LeagueN &lt;lgl&gt;,\n#   DivisionW &lt;lgl&gt;, PutOuts &lt;lgl&gt;, Assists &lt;lgl&gt;, Errors &lt;lgl&gt;,\n#   NewLeagueN &lt;lgl&gt;, r.squared &lt;dbl&gt;, adj.r.squared &lt;dbl&gt;, BIC &lt;dbl&gt;,\n#   mallows_cp &lt;dbl&gt;\n\n\n\n\nCode\nregfit_tidy_prep &lt;- regfit_tidy %&gt;% \n  rowwise() %&gt;% \n  mutate(pred_no = sum(c_across(AtBat:NewLeagueN)), .keep = \"unused\") %&gt;% \n  ungroup() \n  \nregfit_tidy_prep\n\n\n# A tibble: 19 × 6\n   `(Intercept)` r.squared adj.r.squared    BIC mallows_cp pred_no\n   &lt;lgl&gt;             &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;int&gt;\n 1 TRUE              0.321         0.319  -90.8     104.         1\n 2 TRUE              0.425         0.421 -129.       50.7        2\n 3 TRUE              0.451         0.445 -136.       38.7        3\n 4 TRUE              0.475         0.467 -142.       27.9        4\n 5 TRUE              0.491         0.481 -144.       21.6        5\n 6 TRUE              0.509         0.497 -148.       14.0        6\n 7 TRUE              0.514         0.501 -145.       13.1        7\n 8 TRUE              0.529         0.514 -148.        7.40       8\n 9 TRUE              0.535         0.518 -145.        6.16       9\n10 TRUE              0.540         0.522 -143.        5.01      10\n11 TRUE              0.543         0.523 -139.        5.87      11\n12 TRUE              0.544         0.522 -134.        7.33      12\n13 TRUE              0.544         0.521 -129.        8.89      13\n14 TRUE              0.545         0.520 -124.       10.5       14\n15 TRUE              0.545         0.518 -118.       12.3       15\n16 TRUE              0.546         0.516 -113.       14.2       16\n17 TRUE              0.546         0.514 -107.       16.1       17\n18 TRUE              0.546         0.513 -102.       18.0       18\n19 TRUE              0.546         0.511  -96.3      20.0       19\n\n\n\nPlotting \\(C_p\\), BIC, \\(Adjusted R^2\\)\nLet’s create method for autoplot() of class “regsubsets”\n\n\nCode\nautoplot.regsubsets &lt;- function(x, \n                                res = c(\"mallows_cp\", \"BIC\",\"r.squared\",\"adj.r.squared\")\n                                ) {\n  \n  res &lt;- match.arg(res)\n  res_sym &lt;- dplyr::ensym(res)\n  \n  df_params &lt;- broom::tidy(x)\n  df_reduced &lt;- df_params %&gt;% \n    dplyr::rowwise() %&gt;% \n    dplyr::mutate(\n      # Add Number of Predictors\n      pred_no = sum(dplyr::c_across(\n        !tidyselect::any_of(c(\"(Intercept)\", \"r.squared\",\"adj.r.squared\",\n                              \"BIC\",\"mallows_cp\")))), .keep = \"unused\")  %&gt;% \n    dplyr::ungroup() \n  \n  \n  ### Find X & Y-Coordinate of the best model \n  #### i.e., lowest point for \"mallows_cp\", \"BIC\" and highest point for    \"r.squared\",\"adj.r.squared\"\n  fun &lt;- if(res %in% c(\"mallows_cp\", \"BIC\")) min else max\n  \n  best_y &lt;- fun(df_reduced[[res]])\n  best_x &lt;- df_reduced %&gt;% \n      dplyr::filter(!!res_sym == fun(!!res_sym)) %&gt;% dplyr::pull(pred_no)\n  \n  direction_col &lt;- ifelse(res %in% c(\"mallows_cp\", \"BIC\"), -1, 1)\n  \n  # Plot\n  df_reduced %&gt;%\n    ggplot2::ggplot(ggplot2::aes(pred_no, !!res_sym, color = !!res_sym)) +\n    ggplot2::geom_point(show.legend = F) +\n    ggplot2::geom_line(show.legend = F) +\n    ggplot2::scale_color_viridis_c(option = \"plasma\", end = 0.8, \n                                   direction = direction_col) +\n    ggplot2::annotate(\"point\", x = best_x, y = best_y, shape = 4, size = 5, stroke = 0.5)+\n    ggplot2::labs(x = \"Number of Predictors\") \n  \n}\n\n\n\n\nCode\nlibrary(patchwork)\nlibrary(latex2exp)\n\np_cp &lt;- autoplot(regfit.full, res = \"mallows_cp\") +\n  labs(y = TeX(\"C_p\"))\n\np_bic &lt;- autoplot(regfit.full, res = \"BIC\")\n\np_adj_rsq &lt;- autoplot(regfit.full, res = \"adj.r.squared\") +\n  labs(y = TeX(\"Adjusted R^2\"))\n\np_cp + p_bic + p_adj_rsq +\n  plot_annotation(title = \"Best Subset Selection at Each Model Sizes\", \n                  subtitle = TeX(\"Estimate test error by C_p, BIC, and Adjusted R^2\"),\n                  caption = \"Data from Hitters dataset in ISLR2 package\")"
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html#using-cross-validation",
    "href": "posts/2023-09-27_lm-subset-select/index.html#using-cross-validation",
    "title": "Linear Model Subset Selection",
    "section": "Using Cross-Validation",
    "text": "Using Cross-Validation\nI need to build a lot of helper functions.\n\nPredict Method for “regsubsets”\n“regsubsets” object has no predict() method, so we need to create ourselves.\nLuckily, ISLR’s lab demonstration already included predict.regsubsets() in the R-Markdown material.\nI will modify it a little bit so that it returns a vector instead of matrix.\n\n\nCode\npredict.regsubsets &lt;- function(object, newdata, id, ...) {\n  form &lt;- as.formula(object[[\"call\"]][[2]])\n  mat &lt;- model.matrix(form, newdata)\n  coefi &lt;- coef(object, id = id)\n  xvars &lt;- names(coefi)\n  # Matrix\n  pred_mat &lt;- mat[, xvars] %*% coefi\n  # Vector\n  pred &lt;- as.numeric(pred_mat)\n  names(pred) &lt;- rownames(mat)\n  pred\n}\n\npredict(regfit.full, newdata = Hitters, id = 3) %&gt;% head()\n\n\n      -Alan Ashby      -Alvin Davis     -Andre Dawson -Andres Galarraga \n        611.11976         715.34087         950.55323         424.10211 \n -Alfredo Griffin        -Al Newman \n        708.86493          59.21692 \n\n\n\n\nModel Summary for “regsubsets”\nNext, I will implement broom::glance() method for “regsubsets” object. This will provide a models summary at each number of predictors.\n\n\nCode\nglance.regsubsets &lt;- function(x, newdata, ...) {\n  \n  n_predictors &lt;- x$np - 1\n  y_var &lt;- as.formula(x$call[[2]])[[2]]\n  y &lt;- newdata[[y_var]]\n  \n  mse &lt;- numeric(n_predictors)\n  \n  for (i in 1:n_predictors) {\n    y_hat_i &lt;- predict.regsubsets(x, newdata, id = i, ...)\n\n    # Mean Squared Error\n    mse[[i]] &lt;- mean(c(y - y_hat_i)^2)\n  }\n  \n  \n  tibble::tibble(\n    n_predictors = 1:n_predictors,\n    MSE = mse,\n    r.squared = summary(x)[[\"rsq\"]],\n    adj.r.squared = summary(x)[[\"adjr2\"]],\n    mallows_cp = summary(x)[[\"cp\"]],\n    BIC = summary(x)[[\"bic\"]]\n  )\n  \n}\n\nbroom::glance(regfit.full, newdata = Hitters)\n\n\n# A tibble: 19 × 6\n   n_predictors     MSE r.squared adj.r.squared mallows_cp    BIC\n          &lt;int&gt;   &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;\n 1            1 137565.     0.321         0.319     104.    -90.8\n 2            2 116527.     0.425         0.421      50.7  -129. \n 3            3 111214.     0.451         0.445      38.7  -136. \n 4            4 106353.     0.475         0.467      27.9  -142. \n 5            5 103232.     0.491         0.481      21.6  -144. \n 6            6  99600.     0.509         0.497      14.0  -148. \n 7            7  98504.     0.514         0.501      13.1  -145. \n 8            8  95578.     0.529         0.514       7.40 -148. \n 9            9  94350.     0.535         0.518       6.16 -145. \n10           10  93157.     0.540         0.522       5.01 -143. \n11           11  92728.     0.543         0.523       5.87 -139. \n12           12  92522.     0.544         0.522       7.33 -134. \n13           13  92354.     0.544         0.521       8.89 -129. \n14           14  92200.     0.545         0.520      10.5  -124. \n15           15  92149.     0.545         0.518      12.3  -118. \n16           16  92089.     0.546         0.516      14.2  -113. \n17           17  92051.     0.546         0.514      16.1  -107. \n18           18  92022.     0.546         0.513      18.0  -102. \n19           19  92018.     0.546         0.511      20.0   -96.3\n\n\n\n\nSplit Data into Folds\nNow, let’s split data into 10-fold using vfold_cv() function from {rsample} package.\n\n\nCode\nlibrary(rsample)\n\n\n\n\nCode\nset.seed(123)\n\nHitters_folds &lt;- vfold_cv(Hitters, v = 10) \n\nclass(Hitters_folds)\n\n\n[1] \"vfold_cv\"   \"rset\"       \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\nCode\nHitters_folds\n\n\n#  10-fold cross-validation \n# A tibble: 10 × 2\n   splits           id    \n   &lt;list&gt;           &lt;chr&gt; \n 1 &lt;split [236/27]&gt; Fold01\n 2 &lt;split [236/27]&gt; Fold02\n 3 &lt;split [236/27]&gt; Fold03\n 4 &lt;split [237/26]&gt; Fold04\n 5 &lt;split [237/26]&gt; Fold05\n 6 &lt;split [237/26]&gt; Fold06\n 7 &lt;split [237/26]&gt; Fold07\n 8 &lt;split [237/26]&gt; Fold08\n 9 &lt;split [237/26]&gt; Fold09\n10 &lt;split [237/26]&gt; Fold10\n\n\nAnalysis (train) and Assessment (hold-out) data can be obtained by analysis() and assessment(), respectively.\n\n\nCode\nHitters_folds$splits[[1]] %&gt;% analysis()\n\n\n                   AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun\n-Alan Ashby          315   81     7   24  38    39    14   3449   835     69\n-Alvin Davis         479  130    18   66  72    76     3   1624   457     63\n-Andre Dawson        496  141    20   65  78    37    11   5628  1575    225\n-Andres Galarraga    321   87    10   39  42    30     2    396   101     12\n-Alfredo Griffin     594  169     4   74  51    35    11   4408  1133     19\n-Al Newman           185   37     1   23   8    21     2    214    42      1\n-Argenis Salazar     298   73     0   24  24     7     3    509   108      0\n-Andres Thomas       323   81     6   26  32     8     2    341    86      6\n-Andre Thornton      401   92    17   49  66    65    13   5206  1332    253\n-Alan Trammell       574  159    21  107  75    59    10   4631  1300     90\n-Andy VanSlyke       418  113    13   48  61    47     4   1512   392     41\n-Alan Wiggins        239   60     0   30  11    22     6   1941   510      4\n-Bill Almon          196   43     7   29  27    30    13   3231   825     36\n-Buddy Bell          568  158    20   89  75    73    15   8068  2273    177\n-Buddy Biancalana    190   46     2   24   8    15     5    479   102      5\n-Bruce Bochy         127   32     8   16  22    14     8    727   180     24\n-Bobby Bonilla       426  109     3   55  43    62     1    426   109      3\n-Bob Brenly          472  116    16   60  62    74     6   1924   489     67\n-Bill Buckner        629  168    18   73 102    40    18   8424  2464    164\n-Brett Butler        587  163     4   92  51    70     6   2695   747     17\n-Bob Dernier         324   73     4   32  18    22     7   1931   491     13\n-Bo Diaz             474  129    10   50  56    40    10   2331   604     61\n-Brian Downing       513  137    20   90  95    90    14   5201  1382    166\n-Billy Hatcher       419  108     6   55  36    22     3    591   149      8\n-Bob Kearney         204   49     6   23  25    12     7   1309   308     27\n-Bill Madlock        379  106    10   38  60    30    14   6207  1906    146\n-Bob Melvin          268   60     5   24  25    15     2    350    78      5\n-BillyJo Robidoux    181   41     1   15  21    33     2    232    50      4\n-Bill Schroeder      217   46     7   32  19     9     4    694   160     32\n-Chris Bando         254   68     2   28  26    22     6    999   236     21\n-Chris Brown         416  132     7   57  49    33     3    932   273     24\n-Carmen Castillo     205   57     8   34  32     9     5    756   192     32\n-Chili Davis         526  146    13   71  70    84     6   2648   715     77\n-Carlton Fisk        457  101    14   42  63    22    17   6521  1767    281\n-Curt Ford           214   53     2   30  29    23     2    226    59      2\n-Carney Lansford     591  168    19   80  72    39     9   4478  1307    113\n-Chet Lemon          403  101    12   45  53    39    12   5150  1429    166\n-Candy Maldonado     405  102    18   49  85    20     6    950   231     29\n-Carmelo Martinez    244   58     9   28  25    35     4   1335   333     49\n-Craig Reynolds      313   78     6   32  41    12    12   3742   968     35\n-Cal Ripken          627  177    25   98  81    70     6   3210   927    133\n-Cory Snyder         416  113    24   58  69    16     1    416   113     24\n-Chris Speier        155   44     6   21  23    15    16   6631  1634     98\n-Curt Wilkerson      236   56     0   27  15    11     4   1115   270      1\n-Dave Anderson       216   53     1   31  15    22     4    926   210      9\n-Don Baylor          585  139    31   93  94    62    17   7546  1982    315\n-Daryl Boston        199   53     5   29  22    21     3    514   120      8\n-Darnell Coles       521  142    20   67  86    45     4    815   205     22\n-Doug DeCinces       512  131    26   69  96    52    14   5347  1397    221\n-Darrell Evans       507  122    29   78  85    91    18   7761  1947    347\n-Dwight Evans        529  137    26   86  97    97    15   6661  1785    291\n-Damaso Garcia       424  119     6   57  46    13     9   3651  1046     32\n-Dan Gladden         351   97     4   55  29    39     4   1258   353     16\n-Davey Lopes         255   70     7   49  35    43    15   6311  1661    154\n-Don Mattingly       677  238    31  117 113    53     5   2223   737     93\n-Dale Murphy         614  163    29   89  83    75    11   5017  1388    266\n-Dwayne Murphy       329   83     9   50  39    56     9   3828   948    145\n-Dave Parker         637  174    31   89 116    56    14   6727  2024    247\n-Dan Pasqua          280   82    16   44  45    47     2    428   113     25\n-Darrell Porter      155   41    12   21  29    22    16   5409  1338    181\n-Dick Schofield      458  114    13   67  57    48     4   1350   298     28\n-Don Slaught         314   83    13   39  46    16     5   1457   405     28\n-Darryl Strawberry   475  123    27   76  93    72     4   1810   471    108\n-Dale Sveum          317   78     7   35  35    32     1    317    78      7\n-Danny Tartabull     511  138    25   76  96    61     3    592   164     28\n-Denny Walling       382  119    13   54  58    36    12   2133   594     41\n-Dave Winfield       565  148    24   90 104    77    14   7287  2083    305\n-Eric Davis          415  115    27   97  71    68     3    711   184     45\n-Eddie Milner        424  110    15   70  47    36     7   2130   544     38\n-Eddie Murray        495  151    17   61  84    78    10   5624  1679    275\n-Ed Romero           233   49     2   41  23    18     8   1350   336      7\n-Frank White         566  154    22   76  84    43    14   6100  1583    131\n-George Bell         641  198    31  101 108    41     5   2129   610     92\n-Glenn Braggs        215   51     4   19  18    11     1    215    51      4\n-George Brett        441  128    16   70  73    80    14   6675  2095    209\n-Greg Brock          325   76    16   33  52    37     5   1506   351     71\n-Gary Carter         490  125    24   81 105    62    13   6063  1646    271\n-Glenn Davis         574  152    31   91 101    64     3    985   260     53\n-Gary Gaetti         596  171    34   91 108    52     6   2862   728    107\n-Greg Gagne          472  118    12   63  54    30     4    793   187     14\n-George Hendrick     283   77    14   45  47    26    16   6840  1910    259\n-Glenn Hubbard       408   94     4   42  36    66     9   3573   866     59\n-Garth Iorg          327   85     3   30  44    20     8   2140   568     16\n-Graig Nettles       354   77    16   36  55    41    20   8716  2172    384\n-Gary Pettis         539  139     5   93  58    69     5   1469   369     12\n-Gary Redus          340   84    11   62  33    47     5   1516   376     42\n-Garry Templeton     510  126     2   42  44    35    11   5562  1578     44\n-Greg Walker         282   78    13   37  51    29     5   1649   453     73\n-Glenn Wilson        584  158    15   70  84    42     5   2358   636     58\n-Harold Baines       570  169    21   72  88    38     7   3754  1077    140\n-Hubie Brooks        306  104    14   50  58    25     7   2954   822     55\n-Howard Johnson      220   54    10   30  39    31     5   1185   299     40\n-Harold Reynolds     445   99     1   46  24    29     4    618   129      1\n-Harry Spilman       143   39     5   18  30    15     9    639   151     16\n-Herm Winningham     185   40     4   23  11    18     3    524   125      7\n-Juan Beniquez       343  103     6   48  36    40    15   4338  1193     70\n-John Cangelosi      438  103     2   65  32    71     2    440   103      2\n-Jose Canseco        600  144    33   85 117    65     2    696   173     38\n-Joe Carter          663  200    29  108 121    32     4   1447   404     57\n-Jack Clark          232   55     9   34  23    45    12   4405  1213    194\n-Jose Cruz           479  133    10   48  72    55    17   7472  2147    153\n-Jody Davis          528  132    21   61  74    41     6   2641   671     97\n-Jim Dwyer           160   39     8   18  31    22    14   2128   543     56\n-Julio Franco        599  183    10   80  74    32     5   2482   715     27\n-Jim Gantner         497  136     7   58  38    26    11   3871  1066     40\n-Johnny Grubb        210   70    13   32  51    28    15   4040  1130     97\n-Jack Howell         151   41     4   26  21    19     2    288    68      9\n-John Kruk           278   86     4   33  38    45     1    278    86      4\n-Jeffrey Leonard     341   95     6   48  42    20    10   2964   808     81\n-Jim Morrison        537  147    23   58  88    47    10   2744   730     97\n-John Moses          399  102     3   56  34    34     5    670   167      4\n-Jerry Mumphrey      309   94     5   37  32    26    13   4618  1330     57\n-Jim Presley         616  163    27   83 107    32     3   1437   377     65\n-Johnny Ray          579  174     7   67  78    58     6   3053   880     32\n-Jeff Reed           165   39     2   13   9    16     3    196    44      2\n-Jim Rice            618  200    20   98 110    62    13   7127  2163    351\n-Jerry Royster       257   66     5   31  26    32    14   3910   979     33\n-John Russell        315   76    13   35  60    25     3    630   151     24\n-Juan Samuel         591  157    16   90  78    26     4   2020   541     52\n-John Shelby         404   92    11   54  49    18     6   1354   325     30\n-Joel Skinner        315   73     5   23  37    16     4    450   108      6\n-Jim Sundberg        429   91    12   41  42    57    13   5590  1397     83\n-Joel Youngblood     184   47     5   20  28    18    11   3327   890     74\n-Kevin Bass          591  184    20   83  79    38     5   1689   462     40\n-Kirk Gibson         441  118    28   84  86    68     8   2723   750    126\n-Ken Griffey         490  150    21   69  58    35    14   6126  1839    121\n-Keith Hernandez     551  171    13   94  83    94    13   6090  1840    128\n-Kent Hrbek          550  147    29   85  91    71     6   2816   815    117\n-Ken Landreaux       283   74     4   34  29    22    10   3919  1062     85\n-Kevin McReynolds    560  161    26   89  96    66     4   1789   470     65\n-Kevin Mitchell      328   91    12   51  43    33     2    342    94     12\n-Keith Moreland      586  159    12   72  79    53     9   3082   880     83\n-Ken Oberkfell       503  136     5   62  48    83    10   3423   970     20\n-Ken Phelps          344   85    24   69  64    88     7    911   214     64\n-Kirby Puckett       680  223    31  119  96    34     3   1928   587     35\n-Kurt Stillwell      279   64     0   31  26    30     1    279    64      0\n-Leon Durham         484  127    20   66  65    67     7   3006   844    116\n-Len Dykstra         431  127     8   77  45    58     2    667   187      9\n-Larry Herndon       283   70     8   33  37    27    12   4479  1222     94\n-Lee Lacy            491  141    11   77  47    37    15   4291  1240     84\n-Len Matuszek        199   52     9   26  28    21     6    805   191     30\n-Lloyd Moseby        589  149    21   89  86    64     7   3558   928    102\n-Lance Parrish       327   84    22   53  62    38    10   4273  1123    212\n-Larry Parrish       464  128    28   67  94    52    13   5829  1552    210\n-Larry Sheets        338   92    18   42  60    21     3    682   185     36\n-Lou Whitaker        584  157    20   95  73    63    10   4704  1320     93\n-Marty Barrett       625  179     4   94  60    65     5   1696   476     12\n-Mike Davis          489  131    19   77  55    34     7   2051   549     62\n-Mike Diaz           209   56    12   22  36    19     2    216    58     12\n-Mariano Duncan      407   93     8   47  30    30     2    969   230     14\n-Mike Easler         490  148    14   64  78    49    13   3400  1000    113\n-Mel Hall            442  131    18   68  77    33     6   1416   398     47\n-Mike LaValliere     303   71     3   18  30    36     3    344    76      3\n-Mike Marshall       330   77    19   47  53    27     6   1928   516     90\n-Mike Pagliarulo     504  120    28   71  71    54     3   1085   259     54\n-Mark Salas          258   60     8   28  33    18     3    638   170     17\n-Mike Schmidt         20    1     0    0   0     0     2     41     9      2\n-Mike Scioscia       374   94     5   36  26    62     7   1968   519     26\n-Mickey Tettleton    211   43    10   26  35    39     3    498   116     14\n-Milt Thompson       299   75     6   38  23    26     3    580   160      8\n-Mitch Webster       576  167     8   89  49    57     4    822   232     19\n-Mookie Wilson       381  110     9   61  45    32     7   3015   834     40\n-Mike Young          369   93     9   43  42    49     5   1258   323     54\n-Ozzie Guillen       547  137     2   58  47    12     2   1038   271      3\n-Oddibe McDowell     572  152    18  105  49    65     2    978   249     36\n-Ozzie Smith         514  144     0   67  54    79     9   4739  1169     13\n-Ozzie Virgil        359   80    15   45  48    63     7   1493   359     61\n-Phil Bradley        526  163    12   88  50    77     4   1556   470     38\n-Phil Garner         313   83     9   43  41    30    14   5885  1543    104\n-Pete Rose           237   52     0   15  25    30    24  14053  4256    160\n-Pat Sheridan        236   56     6   41  19    21     5   1257   329     24\n-Pat Tabler          473  154     6   61  48    29     6   1966   566     29\n-Rafael Belliard     309   72     0   33  31    26     5    354    82      0\n-Randy Bush          357   96     7   50  45    39     5   1394   344     43\n-Rick Cerone         216   56     4   22  18    15    12   2796   665     43\n-Ron Cey             256   70    13   42  36    44    16   7058  1845    312\n-Rob Deer            466  108    33   75  86    72     3    652   142     44\n-Rick Dempsey        327   68    13   42  29    45    18   3949   939     78\n-Ron Hassey          341  110     9   45  49    46     9   2331   658     50\n-Rickey Henderson    608  160    28  130  74    89     8   4071  1182    103\n-Reggie Jackson      419  101    18   65  58    92    20   9528  2510    548\n-Ron Kittle          376   82    21   42  60    35     5   1770   408    115\n-Ray Knight          486  145    11   51  76    40    11   3967  1102     67\n-Rick Leach          246   76     5   35  39    13     6    912   234     12\n-Rance Mulliniks     348   90    11   50  45    43    10   2288   614     43\n-Ron Oester          523  135     8   52  44    52     9   3368   895     39\n-Ronn Reynolds       126   27     3    8  10     5     4    239    49      3\n-Ron Roenicke        275   68     5   42  42    61     6    961   238     16\n-Ryne Sandberg       627  178    14   68  76    46     6   3146   902     74\n-Rafael Santana      394   86     1   38  28    36     4   1089   267      3\n-Rick Schu           208   57     8   32  25    18     3    653   170     17\n-Ruben Sierra        382  101    16   50  55    22     1    382   101     16\n-Roy Smalley         459  113    20   59  57    68    12   5348  1369    155\n-Robby Thompson      549  149     7   73  47    42     1    549   149      7\n-Rob Wilfong         288   63     3   25  33    16    10   2682   667     38\n-Robin Yount         522  163     9   82  46    62    13   7037  2019    153\n-Steve Balboni       512  117    29   54  88    43     6   1750   412    100\n-Scott Bradley       220   66     5   20  28    13     3    290    80      5\n-Sid Bream           522  140    16   73  77    60     4    730   185     22\n-Steve Buechele      461  112    18   54  54    35     2    680   160     24\n-Shawon Dunston      581  145    17   66  68    21     2    831   210     21\n-Scott Fletcher      530  159     3   82  50    47     6   1619   426     11\n-Steve Garvey        557  142    21   58  81    23    18   8759  2583    271\n-Steve Jeltz         439   96     0   44  36    65     4    711   148      1\n-Steve Lombardozzi   453  103     8   53  33    52     2    507   123      8\n-Spike Owen          528  122     1   67  45    51     4   1716   403     12\n-Steve Sax           633  210     6   91  56    59     6   3070   872     19\n-Tony Bernazard      562  169    17   88  73    53     8   3181   841     61\n-Tom Brookens        281   76     3   42  25    20     8   2658   657     48\n-Tom Brunansky       593  152    23   69  75    53     6   2765   686    133\n-Tony Fernandez      687  213    10   91  65    27     4   1518   448     15\n-Tom Foley           263   70     1   26  23    30     4    888   220      9\n-Tony Gwynn          642  211    14  107  59    52     5   2364   770     27\n-Terry Harper        265   68     8   26  30    29     7   1337   339     32\n-Tommy Herr          559  141     2   48  61    73     8   3162   874     16\n-Tim Hulett          520  120    17   53  44    21     4    927   227     22\n-Terry Kennedy        19    4     1    2   3     1     1     19     4      1\n-Tito Landrum        205   43     2   24  17    20     7    854   219     12\n-Tim Laudner         193   47    10   21  29    24     6   1136   256     42\n-Tom Paciorek        213   61     4   17  22     3    17   4061  1145     83\n-Tony Pena           510  147    10   56  52    53     7   2872   821     63\n-Terry Pendleton     578  138     1   56  59    34     3   1399   357      7\n-Tony Phillips       441  113     5   76  52    76     5   1546   397     17\n-Terry Puhl          172   42     3   17  14    15    10   4086  1150     57\n-Ted Simmons         127   32     4   14  25    12    19   8396  2402    242\n-Tim Teufel          279   69     4   35  31    32     4   1359   355     31\n-Vince Coleman       600  139     0   94  29    60     2   1236   309      1\n-Von Hayes           610  186    19  107  98    74     6   2728   753     69\n-Vance Law           360   81     5   37  44    37     7   2268   566     41\n-Wally Backman       387  124     1   67  27    36     7   1775   506      6\n-Will Clark          408  117    11   66  41    34     1    408   117     11\n-Wally Joyner        593  172    22   82 100    57     1    593   172     22\n-Willie Randolph     492  136     5   76  50    94    12   5511  1511     39\n-Wayne Tolleson      475  126     3   61  43    52     6   1700   433      7\n-Willie Upshaw       573  144     9   85  60    78     8   3198   857     97\n-Willie Wilson       631  170     9   77  44    31    11   4908  1457     30\n                   CRuns CRBI CWalks League Division PutOuts Assists Errors\n-Alan Ashby          321  414    375      N        W     632      43     10\n-Alvin Davis         224  266    263      A        W     880      82     14\n-Andre Dawson        828  838    354      N        E     200      11      3\n-Andres Galarraga     48   46     33      N        E     805      40      4\n-Alfredo Griffin     501  336    194      A        W     282     421     25\n-Al Newman            30    9     24      N        E      76     127      7\n-Argenis Salazar      41   37     12      A        W     121     283      9\n-Andres Thomas        32   34      8      N        W     143     290     19\n-Andre Thornton      784  890    866      A        E       0       0      0\n-Alan Trammell       702  504    488      A        E     238     445     22\n-Andy VanSlyke       205  204    203      N        E     211      11      7\n-Alan Wiggins        309  103    207      A        E     121     151      6\n-Bill Almon          376  290    238      N        E      80      45      8\n-Buddy Bell         1045  993    732      N        W     105     290     10\n-Buddy Biancalana     65   23     39      A        W     102     177     16\n-Bruce Bochy          67   82     56      N        W     202      22      2\n-Bobby Bonilla        55   43     62      A        W     361      22      2\n-Bob Brenly          242  251    240      N        W     518      55      3\n-Bill Buckner       1008 1072    402      A        E    1067     157     14\n-Brett Butler        442  198    317      A        E     434       9      3\n-Bob Dernier         291  108    180      N        E     222       3      3\n-Bo Diaz             246  327    166      N        W     732      83     13\n-Brian Downing       763  734    784      A        W     267       5      3\n-Billy Hatcher        80   46     31      N        W     226       7      4\n-Bob Kearney         126  132     66      A        W     419      46      5\n-Bill Madlock        859  803    571      N        W      72     170     24\n-Bob Melvin           34   29     18      N        W     442      59      6\n-BillyJo Robidoux     20   29     45      A        E     326      29      5\n-Bill Schroeder       86   76     32      A        E     307      25      1\n-Chris Bando         108  117    118      A        E     359      30      4\n-Chris Brown         113  121     80      N        W      73     177     18\n-Carmen Castillo     117  107     51      A        E      58       4      4\n-Chili Davis         352  342    289      N        W     303       9      9\n-Carlton Fisk       1003  977    619      A        W     389      39      4\n-Curt Ford            32   32     27      N        E     109       7      3\n-Carney Lansford     634  563    319      A        W      67     147      4\n-Chet Lemon          747  666    526      A        E     316       6      5\n-Candy Maldonado      99  138     64      N        W     161      10      3\n-Carmelo Martinez    164  179    194      N        W     142      14      2\n-Craig Reynolds      409  321    170      N        W     106     206      7\n-Cal Ripken          529  472    313      A        E     240     482     13\n-Cory Snyder          58   69     16      A        E     203      70     10\n-Chris Speier        698  661    777      N        E      53      88      3\n-Curt Wilkerson      116   64     57      A        W     125     199     13\n-Dave Anderson       118   69    114      N        W      73     152     11\n-Don Baylor         1141 1179    727      A        E       0       0      0\n-Daryl Boston         57   40     39      A        W     152       3      5\n-Darnell Coles        99  103     78      A        E     107     242     23\n-Doug DeCinces       712  815    548      A        W     119     216     12\n-Darrell Evans      1175 1152   1380      A        E     808     108      2\n-Dwight Evans       1082  949    989      A        E     280      10      5\n-Damaso Garcia       461  301    112      A        E     224     286      8\n-Dan Gladden         196  110    117      N        W     226       7      3\n-Davey Lopes        1019  608    820      N        E      51      54      8\n-Don Mattingly       349  401    171      A        E    1377     100      6\n-Dale Murphy         813  822    617      N        W     303       6      6\n-Dwayne Murphy       575  528    635      A        W     276       6      2\n-Dave Parker         978 1093    495      N        W     278       9      9\n-Dan Pasqua           61   70     63      A        E     148       4      2\n-Darrell Porter      746  805    875      A        W     165       9      1\n-Dick Schofield      160  123    122      A        W     246     389     18\n-Don Slaught         156  159     76      A        W     533      40      4\n-Darryl Strawberry   292  343    267      N        E     226      10      6\n-Dale Sveum           35   35     32      A        E      45     122     26\n-Danny Tartabull      87  110     71      A        W     157       7      8\n-Denny Walling       287  294    227      N        W      59     156      9\n-Dave Winfield      1135 1234    791      A        E     292       9      5\n-Eric Davis          156  119     99      N        W     274       2      7\n-Eddie Milner        335  174    258      N        W     292       6      3\n-Eddie Murray        884 1015    709      A        E    1045      88     13\n-Ed Romero           166  122    106      A        E     102     132     10\n-Frank White         743  693    300      A        W     316     439     10\n-George Bell         297  319    117      A        E     269      17     10\n-Glenn Braggs         19   18     11      A        E     116       5     12\n-George Brett       1072 1050    695      A        W      97     218     16\n-Greg Brock          195  219    214      N        W     726      87      3\n-Gary Carter         847  999    680      N        E     869      62      8\n-Glenn Davis         148  173     95      N        W    1253     111     11\n-Gary Gaetti         361  401    224      A        W     118     334     21\n-Greg Gagne          102   80     50      A        W     228     377     26\n-George Hendrick     915 1067    546      A        W     144       6      5\n-Glenn Hubbard       429  365    410      N        W     282     487     19\n-Garth Iorg          216  208     93      A        E      91     185     12\n-Graig Nettles      1172 1267   1057      N        W      83     174     16\n-Gary Pettis         247  126    198      A        W     462       9      7\n-Gary Redus          284  141    219      N        E     185       8      4\n-Garry Templeton     703  519    256      N        W     207     358     20\n-Greg Walker         211  280    138      A        W     670      57      5\n-Glenn Wilson        265  316    134      N        E     331      20      4\n-Harold Baines       492  589    263      A        W     295      15      5\n-Hubie Brooks        313  377    187      N        E     116     222     15\n-Howard Johnson      145  154    128      N        E      50     136     20\n-Harold Reynolds      72   31     48      A        W     278     415     16\n-Harry Spilman        80   97     61      N        W     138      15      1\n-Herm Winningham      58   37     47      N        E      97       2      2\n-Juan Beniquez       581  421    325      A        E     211      56     13\n-John Cangelosi       67   32     71      A        W     276       7      9\n-Jose Canseco        101  130     69      A        W     319       4     14\n-Joe Carter          210  222     68      A        E     241       8      6\n-Jack Clark          702  705    625      N        E     623      35      3\n-Jose Cruz           980 1032    854      N        W     237       5      4\n-Jody Davis          273  383    226      N        E     885     105      8\n-Jim Dwyer           304  268    298      A        E      33       3      0\n-Julio Franco        330  326    158      A        E     231     374     18\n-Jim Gantner         450  367    241      A        E     304     347     10\n-Johnny Grubb        544  462    551      A        E       0       0      0\n-Jack Howell          45   39     35      A        W      28      56      2\n-John Kruk            33   38     45      N        W     102       4      2\n-Jeffrey Leonard     379  428    221      N        W     158       4      5\n-Jim Morrison        302  351    174      N        E      92     257     20\n-John Moses           89   48     54      A        W     211       9      3\n-Jerry Mumphrey      616  522    436      N        E     161       3      3\n-Jim Presley         181  227     82      A        W     110     308     15\n-Johnny Ray          366  337    218      N        E     280     479      5\n-Jeff Reed            18   10     18      A        W     332      19      2\n-Jim Rice           1104 1289    564      A        E     330      16      8\n-Jerry Royster       518  324    382      N        W      87     166     14\n-John Russell         68   94     55      N        E     498      39     13\n-Juan Samuel         310  226     91      N        E     290     440     25\n-John Shelby         188  135     63      A        E     222       5      5\n-Joel Skinner         38   46     28      A        W     227      15      3\n-Jim Sundberg        578  579    644      A        W     686      46      4\n-Joel Youngblood     419  382    304      N        W      49       2      0\n-Kevin Bass          219  195     82      N        W     303      12      5\n-Kirk Gibson         433  420    309      A        E     190       2      2\n-Ken Griffey         983  707    600      A        E      96       5      3\n-Keith Hernandez     969  900    917      N        E    1199     149      5\n-Kent Hrbek          405  474    319      A        W    1218     104     10\n-Ken Landreaux       505  456    283      N        W     145       5      7\n-Kevin McReynolds    233  260    155      N        W     332       9      8\n-Kevin Mitchell       51   44     33      N        E     145      59      8\n-Keith Moreland      363  477    295      N        E     181      13      4\n-Ken Oberkfell       408  303    414      N        W      65     258      8\n-Ken Phelps          150  156    187      A        W       0       0      0\n-Kirby Puckett       262  201     91      A        W     429       8      6\n-Kurt Stillwell       31   26     30      N        W     107     205     16\n-Leon Durham         436  458    377      N        E    1231      80      7\n-Len Dykstra         117   64     88      N        E     283       8      3\n-Larry Herndon       557  483    307      A        E     156       2      2\n-Lee Lacy            615  430    340      A        E     239       8      2\n-Len Matuszek        113  119     87      N        W     235      22      5\n-Lloyd Moseby        513  471    351      A        E     371       6      6\n-Lance Parrish       577  700    334      A        E     483      48      6\n-Larry Parrish       740  840    452      A        W       0       0      0\n-Larry Sheets         88  112     50      A        E       0       0      0\n-Lou Whitaker        724  522    576      A        E     276     421     11\n-Marty Barrett       216  163    166      A        E     303     450     14\n-Mike Davis          300  263    153      A        W     310       9      9\n-Mike Diaz            24   37     19      N        E     201       6      3\n-Mariano Duncan      121   69     68      N        W     172     317     25\n-Mike Easler         445  491    301      A        E       0       0      0\n-Mel Hall            210  203    136      A        E     233       7      7\n-Mike LaValliere      20   36     45      N        E     468      47      6\n-Mike Marshall       247  288    161      N        W     149       8      6\n-Mike Pagliarulo     150  167    114      A        E     103     283     19\n-Mark Salas           80   75     36      A        W     358      32      8\n-Mike Schmidt          6    7      4      N        E      78     220      6\n-Mike Scioscia       181  199    288      N        W     756      64     15\n-Mickey Tettleton     59   55     78      A        W     463      32      8\n-Milt Thompson        71   33     44      N        E     212       1      2\n-Mitch Webster       132   83     79      N        E     325      12      8\n-Mookie Wilson       451  249    168      N        E     228       7      5\n-Mike Young          181  177    157      A        E     149       1      6\n-Ozzie Guillen       129   80     24      A        W     261     459     22\n-Oddibe McDowell     168   91    101      A        W     325      13      3\n-Ozzie Smith         583  374    528      N        E     229     453     15\n-Ozzie Virgil        176  202    175      N        W     682      93     13\n-Phil Bradley        245  167    174      A        W     250      11      1\n-Phil Garner         751  714    535      N        W      58     141     23\n-Pete Rose          2165 1314   1566      N        W     523      43      6\n-Pat Sheridan        166  125    105      A        E     172       1      4\n-Pat Tabler          250  252    178      A        E     846      84      9\n-Rafael Belliard      41   32     26      N        E     117     269     12\n-Randy Bush          178  192    136      A        W     167       2      4\n-Rick Cerone         266  304    198      A        E     391      44      4\n-Ron Cey             965 1128    990      N        E      41     118      8\n-Rob Deer            102  109    102      A        E     286       8      8\n-Rick Dempsey        438  380    466      A        E     659      53      7\n-Ron Hassey          249  322    274      A        E     251       9      4\n-Rickey Henderson    862  417    708      A        E     426       4      6\n-Reggie Jackson     1509 1659   1342      A        W       0       0      0\n-Ron Kittle          238  299    157      A        W       0       0      0\n-Ray Knight          410  497    284      N        E      88     204     16\n-Rick Leach          102   96     80      A        E      44       0      1\n-Rance Mulliniks     295  273    269      A        E      60     176      6\n-Ron Oester          377  284    296      N        W     367     475     19\n-Ronn Reynolds        16   13     14      N        E     190       2      9\n-Ron Roenicke        128  104    172      N        E     181       3      2\n-Ryne Sandberg       494  345    242      N        E     309     492      5\n-Rafael Santana       94   71     76      N        E     203     369     16\n-Rick Schu            98   54     62      N        E      42      94     13\n-Ruben Sierra         50   55     22      A        W     200       7      6\n-Roy Smalley         713  660    735      A        W       0       0      0\n-Robby Thompson       73   47     42      N        W     255     450     17\n-Rob Wilfong         315  259    204      A        W     135     257      7\n-Robin Yount        1043  827    535      A        E     352       9      1\n-Steve Balboni       204  276    155      A        W    1236      98     18\n-Scott Bradley        27   31     15      A        W     281      21      3\n-Sid Bream            93  106     86      N        E    1320     166     17\n-Steve Buechele       76   75     49      A        W     111     226     11\n-Shawon Dunston      106   86     40      N        E     320     465     32\n-Scott Fletcher      218  149    163      A        W     196     354     15\n-Steve Garvey       1138 1299    478      N        W    1160      53      7\n-Steve Jeltz          68   56     99      N        E     229     406     22\n-Steve Lombardozzi    63   39     58      A        W     289     407      6\n-Spike Owen          211  146    155      A        W     209     372     17\n-Steve Sax           420  230    274      N        W     367     432     16\n-Tony Bernazard      450  342    373      A        E     351     442     17\n-Tom Brookens        324  300    179      A        E     106     144      7\n-Tom Brunansky       369  384    321      A        W     315      10      6\n-Tony Fernandez      196  137     89      A        E     294     445     13\n-Tom Foley            83   82     86      N        E      81     147      4\n-Tony Gwynn          352  230    193      N        W     337      19      4\n-Terry Harper        135  163    128      N        W      92       5      3\n-Tommy Herr          421  349    359      N        E     352     414      9\n-Tim Hulett          106   80     52      A        W      70     144     11\n-Terry Kennedy         2    3      1      N        W     692      70      8\n-Tito Landrum        105   99     71      N        E     131       6      1\n-Tim Laudner         129  139    106      A        W     299      13      5\n-Tom Paciorek        488  491    244      A        W     178      45      4\n-Tony Pena           307  340    174      N        E     810      99     18\n-Terry Pendleton     149  161     87      N        E     133     371     20\n-Tony Phillips       226  149    191      A        W     160     290     11\n-Terry Puhl          579  363    406      N        W      65       0      0\n-Ted Simmons        1048 1348    819      N        W     167      18      6\n-Tim Teufel          180  148    158      N        E     133     173      9\n-Vince Coleman       201   69    110      N        E     300      12      9\n-Von Hayes           399  366    286      N        E    1182      96     13\n-Vance Law           279  257    246      N        E     170     284      3\n-Wally Backman       272  125    194      N        E     186     290     17\n-Will Clark           66   41     34      N        W     942      72     11\n-Wally Joyner         82  100     57      A        W    1222     139     15\n-Willie Randolph     897  451    875      A        E     313     381     20\n-Wayne Tolleson      217   93    146      A        W      37     113      7\n-Willie Upshaw       470  420    332      A        E    1314     131     12\n-Willie Wilson       775  357    249      A        W     408       4      3\n                     Salary NewLeague\n-Alan Ashby         475.000         N\n-Alvin Davis        480.000         A\n-Andre Dawson       500.000         N\n-Andres Galarraga    91.500         N\n-Alfredo Griffin    750.000         A\n-Al Newman           70.000         A\n-Argenis Salazar    100.000         A\n-Andres Thomas       75.000         N\n-Andre Thornton    1100.000         A\n-Alan Trammell      517.143         A\n-Andy VanSlyke      550.000         N\n-Alan Wiggins       700.000         A\n-Bill Almon         240.000         N\n-Buddy Bell         775.000         N\n-Buddy Biancalana   175.000         A\n-Bruce Bochy        135.000         N\n-Bobby Bonilla      115.000         N\n-Bob Brenly         600.000         N\n-Bill Buckner       776.667         A\n-Brett Butler       765.000         A\n-Bob Dernier        708.333         N\n-Bo Diaz            750.000         N\n-Brian Downing      900.000         A\n-Billy Hatcher      110.000         N\n-Bob Kearney        300.000         A\n-Bill Madlock       850.000         N\n-Bob Melvin          90.000         N\n-BillyJo Robidoux    67.500         A\n-Bill Schroeder     180.000         A\n-Chris Bando        305.000         A\n-Chris Brown        215.000         N\n-Carmen Castillo    247.500         A\n-Chili Davis        815.000         N\n-Carlton Fisk       875.000         A\n-Curt Ford           70.000         N\n-Carney Lansford   1200.000         A\n-Chet Lemon         675.000         A\n-Candy Maldonado    415.000         N\n-Carmelo Martinez   340.000         N\n-Craig Reynolds     416.667         N\n-Cal Ripken        1350.000         A\n-Cory Snyder         90.000         A\n-Chris Speier       275.000         N\n-Curt Wilkerson     230.000         A\n-Dave Anderson      225.000         N\n-Don Baylor         950.000         A\n-Daryl Boston        75.000         A\n-Darnell Coles      105.000         A\n-Doug DeCinces      850.000         A\n-Darrell Evans      535.000         A\n-Dwight Evans       933.333         A\n-Damaso Garcia      850.000         N\n-Dan Gladden        210.000         A\n-Davey Lopes        450.000         N\n-Don Mattingly     1975.000         A\n-Dale Murphy       1900.000         N\n-Dwayne Murphy      600.000         A\n-Dave Parker       1041.667         N\n-Dan Pasqua         110.000         A\n-Darrell Porter     260.000         A\n-Dick Schofield     475.000         A\n-Don Slaught        431.500         A\n-Darryl Strawberry 1220.000         N\n-Dale Sveum          70.000         A\n-Danny Tartabull    145.000         A\n-Denny Walling      595.000         N\n-Dave Winfield     1861.460         A\n-Eric Davis         300.000         N\n-Eddie Milner       490.000         N\n-Eddie Murray      2460.000         A\n-Ed Romero          375.000         A\n-Frank White        750.000         A\n-George Bell       1175.000         A\n-Glenn Braggs        70.000         A\n-George Brett      1500.000         A\n-Greg Brock         385.000         A\n-Gary Carter       1925.571         N\n-Glenn Davis        215.000         N\n-Gary Gaetti        900.000         A\n-Greg Gagne         155.000         A\n-George Hendrick    700.000         A\n-Glenn Hubbard      535.000         N\n-Garth Iorg         362.500         A\n-Graig Nettles      200.000         N\n-Gary Pettis        400.000         A\n-Gary Redus         400.000         A\n-Garry Templeton    737.500         N\n-Greg Walker        500.000         A\n-Glenn Wilson       662.500         N\n-Harold Baines      950.000         A\n-Hubie Brooks       750.000         N\n-Howard Johnson     297.500         N\n-Harold Reynolds     87.500         A\n-Harry Spilman      175.000         N\n-Herm Winningham     90.000         N\n-Juan Beniquez      430.000         A\n-John Cangelosi     100.000         N\n-Jose Canseco       165.000         A\n-Joe Carter         250.000         A\n-Jack Clark        1300.000         N\n-Jose Cruz          773.333         N\n-Jody Davis        1008.333         N\n-Jim Dwyer          275.000         A\n-Julio Franco       775.000         A\n-Jim Gantner        850.000         A\n-Johnny Grubb       365.000         A\n-Jack Howell         95.000         A\n-John Kruk          110.000         N\n-Jeffrey Leonard    100.000         N\n-Jim Morrison       277.500         N\n-John Moses          80.000         A\n-Jerry Mumphrey     600.000         N\n-Jim Presley        200.000         A\n-Johnny Ray         657.000         N\n-Jeff Reed           75.000         N\n-Jim Rice          2412.500         A\n-Jerry Royster      250.000         A\n-John Russell       155.000         N\n-Juan Samuel        640.000         N\n-John Shelby        300.000         A\n-Joel Skinner       110.000         A\n-Jim Sundberg       825.000         N\n-Joel Youngblood    450.000         N\n-Kevin Bass         630.000         N\n-Kirk Gibson       1300.000         A\n-Ken Griffey       1000.000         N\n-Keith Hernandez   1800.000         N\n-Kent Hrbek        1310.000         A\n-Ken Landreaux      737.500         N\n-Kevin McReynolds   625.000         N\n-Kevin Mitchell     125.000         N\n-Keith Moreland    1043.333         N\n-Ken Oberkfell      725.000         N\n-Ken Phelps         300.000         A\n-Kirby Puckett      365.000         A\n-Kurt Stillwell      75.000         N\n-Leon Durham       1183.333         N\n-Len Dykstra        202.500         N\n-Larry Herndon      225.000         A\n-Lee Lacy           525.000         A\n-Len Matuszek       265.000         N\n-Lloyd Moseby       787.500         A\n-Lance Parrish      800.000         N\n-Larry Parrish      587.500         A\n-Larry Sheets       145.000         A\n-Lou Whitaker       420.000         A\n-Marty Barrett      575.000         A\n-Mike Davis         780.000         A\n-Mike Diaz           90.000         N\n-Mariano Duncan     150.000         N\n-Mike Easler        700.000         N\n-Mel Hall           550.000         A\n-Mike LaValliere    100.000         N\n-Mike Marshall      670.000         N\n-Mike Pagliarulo    175.000         A\n-Mark Salas         137.000         A\n-Mike Schmidt      2127.333         N\n-Mike Scioscia      875.000         N\n-Mickey Tettleton   120.000         A\n-Milt Thompson      140.000         N\n-Mitch Webster      210.000         N\n-Mookie Wilson      800.000         N\n-Mike Young         350.000         A\n-Ozzie Guillen      175.000         A\n-Oddibe McDowell    200.000         A\n-Ozzie Smith       1940.000         N\n-Ozzie Virgil       700.000         N\n-Phil Bradley       750.000         A\n-Phil Garner        450.000         N\n-Pete Rose          750.000         N\n-Pat Sheridan       190.000         A\n-Pat Tabler         580.000         A\n-Rafael Belliard    130.000         N\n-Randy Bush         300.000         A\n-Rick Cerone        250.000         A\n-Ron Cey           1050.000         A\n-Rob Deer           215.000         A\n-Rick Dempsey       400.000         A\n-Ron Hassey         560.000         A\n-Rickey Henderson  1670.000         A\n-Reggie Jackson     487.500         A\n-Ron Kittle         425.000         A\n-Ray Knight         500.000         A\n-Rick Leach         250.000         A\n-Rance Mulliniks    450.000         A\n-Ron Oester         750.000         N\n-Ronn Reynolds      190.000         N\n-Ron Roenicke       191.000         N\n-Ryne Sandberg      740.000         N\n-Rafael Santana     250.000         N\n-Rick Schu          140.000         N\n-Ruben Sierra        97.500         A\n-Roy Smalley        740.000         A\n-Robby Thompson     140.000         N\n-Rob Wilfong        341.667         A\n-Robin Yount       1000.000         A\n-Steve Balboni      100.000         A\n-Scott Bradley       90.000         A\n-Sid Bream          200.000         N\n-Steve Buechele     135.000         A\n-Shawon Dunston     155.000         N\n-Scott Fletcher     475.000         A\n-Steve Garvey      1450.000         N\n-Steve Jeltz        150.000         N\n-Steve Lombardozzi  105.000         A\n-Spike Owen         350.000         A\n-Steve Sax           90.000         N\n-Tony Bernazard     530.000         A\n-Tom Brookens       341.667         A\n-Tom Brunansky      940.000         A\n-Tony Fernandez     350.000         A\n-Tom Foley          250.000         N\n-Tony Gwynn         740.000         N\n-Terry Harper       425.000         A\n-Tommy Herr         925.000         N\n-Tim Hulett         185.000         A\n-Terry Kennedy      920.000         A\n-Tito Landrum       286.667         N\n-Tim Laudner        245.000         A\n-Tom Paciorek       235.000         A\n-Tony Pena         1150.000         N\n-Terry Pendleton    160.000         N\n-Tony Phillips      425.000         A\n-Terry Puhl         900.000         N\n-Ted Simmons        500.000         N\n-Tim Teufel         277.500         N\n-Vince Coleman      160.000         N\n-Von Hayes         1300.000         N\n-Vance Law          525.000         N\n-Wally Backman      550.000         N\n-Will Clark         120.000         N\n-Wally Joyner       165.000         A\n-Willie Randolph    875.000         A\n-Wayne Tolleson     385.000         A\n-Willie Upshaw      960.000         A\n-Willie Wilson     1000.000         A\n\n\nCode\nHitters_folds$splits[[1]] %&gt;% assessment()\n\n\n                 AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun\n-Alex Trevino      202   53     4   31  26    27     9   1876   467     15\n-Barry Bonds       413   92    16   72  48    65     1    413    92     16\n-Bill Doran        550  152     6   92  37    81     5   2308   633     32\n-Brook Jacoby      583  168    17   83  80    56     5   1646   452     44\n-Dave Concepcion   311   81     3   42  30    26    17   8247  2198    100\n-Dave Henderson    388  103    15   59  47    39     6   2174   555     80\n-Donnie Hill       339   96     4   37  29    23     4   1064   290     11\n-Gary Matthews     370   96    21   49  46    60    15   6986  1972    231\n-Gary Ward         380  120     5   54  51    31     8   3118   900     92\n-Hal McRae         278   70     7   22  37    18    18   7186  2081    190\n-Jesse Barfield    589  170    40  107 108    69     6   2325   634    128\n-Jose Uribe        453  101     3   46  43    61     3    948   218      6\n-Kal Daniels       181   58     6   34  23    22     1    181    58      6\n-Mike Aldrete      216   54     2   27  25    33     1    216    54      2\n-Mike Heath        288   65     8   30  36    27     9   2815   698     55\n-Mike Kingery      209   54     3   25  14    12     1    209    54      3\n-Marvell Wynne     288   76     7   34  37    15     4   1644   408     16\n-Pete Incaviglia   540  135    30   82  88    55     1    540   135     30\n-Paul Molitor      437  123     9   62  55    40     9   4139  1203     79\n-Rick Burleson     271   77     5   35  29    33    12   4933  1358     48\n-Rick Manning      205   52     8   31  27    17    12   5134  1323     56\n-Rey Quinones      312   68     2   32  22    24     1    312    68      2\n-Rafael Ramirez    496  119     8   57  33    21     7   3358   882     36\n-Tim Flannery      368  103     3   48  28    54     8   1897   493      9\n-Tim Wallach       480  112    18   50  71    44     7   3031   771    110\n-Wade Boggs        580  207     8  107  71   105     5   2778   978     32\n-Willie McGee      497  127     7   65  48    37     5   2703   806     32\n                 CRuns CRBI CWalks League Division PutOuts Assists Errors\n-Alex Trevino      192  186    161      N        W     304      45     11\n-Barry Bonds        72   48     65      N        E     280       9      5\n-Bill Doran        349  182    308      N        W     262     329     16\n-Brook Jacoby      219  208    136      A        E     109     292     25\n-Dave Concepcion   950  909    690      N        W     153     223     10\n-Dave Henderson    285  274    186      A        W     182       9      4\n-Donnie Hill       123  108     55      A        W     104     213      9\n-Gary Matthews    1070  955    921      N        E     137       5      9\n-Gary Ward         444  419    240      A        W     237       8      1\n-Hal McRae         935 1088    643      A        W       0       0      0\n-Jesse Barfield    371  376    238      A        E     368      20      3\n-Jose Uribe         96   72     91      N        W     249     444     16\n-Kal Daniels        34   23     22      N        W      88       0      3\n-Mike Aldrete       27   25     33      N        W     317      36      1\n-Mike Heath        315  325    189      N        E     259      30     10\n-Mike Kingery       25   14     12      A        W     102       6      3\n-Marvell Wynne     198  120    113      N        W     203       3      3\n-Pete Incaviglia    82   88     55      A        W     157       6     14\n-Paul Molitor      676  390    364      A        E      82     170     15\n-Rick Burleson     630  435    403      A        W      62      90      3\n-Rick Manning      643  445    459      A        E     155       3      2\n-Rey Quinones       32   22     24      A        E      86     150     15\n-Rafael Ramirez    365  280    165      N        W     155     371     29\n-Tim Flannery      207  162    198      N        W     209     246      3\n-Tim Wallach       338  406    239      N        E      94     270     16\n-Wade Boggs        474  322    417      A        E     121     267     19\n-Willie McGee      379  311    138      N        E     325       9      3\n                   Salary NewLeague\n-Alex Trevino     512.500         N\n-Barry Bonds      100.000         N\n-Bill Doran       625.000         N\n-Brook Jacoby     612.500         A\n-Dave Concepcion  320.000         N\n-Dave Henderson   325.000         A\n-Donnie Hill      275.000         A\n-Gary Matthews    733.333         N\n-Gary Ward        600.000         A\n-Hal McRae        325.000         A\n-Jesse Barfield  1237.500         A\n-Jose Uribe       195.000         N\n-Kal Daniels       86.500         N\n-Mike Aldrete      75.000         N\n-Mike Heath       650.000         A\n-Mike Kingery      68.000         A\n-Marvell Wynne    240.000         N\n-Pete Incaviglia  172.000         A\n-Paul Molitor    1260.000         A\n-Rick Burleson    450.000         A\n-Rick Manning     400.000         A\n-Rey Quinones      70.000         A\n-Rafael Ramirez   875.000         N\n-Tim Flannery     326.667         N\n-Tim Wallach      750.000         N\n-Wade Boggs      1600.000         A\n-Willie McGee     700.000         N\n\n\nUp next, regsubsets_cv_glance() will compute cross-validation’s summary statistics using method and functions that I’ve just defined above.\n\n\nCode\nregsubsets_cv_glance &lt;- function(x, vfold_cv, return_folds = FALSE, ...) {\n  \n # Add analysis & assess DF\n vfold_cv &lt;- vfold_cv %&gt;% \n   dplyr::mutate(\n     analysis_df = purrr::map(splits, rsample::analysis),\n     assess_df = purrr::map(splits, rsample::assessment)\n     ) \n  \n  # Fit `regsubsets` to each folds\n  fitted_folds &lt;- vector(\"list\", nrow(vfold_cv))\n  n_predictors &lt;- ncol(vfold_cv$analysis_df[[1]]) - 1 # Number of Predictors\n\n  for (i in 1:nrow(vfold_cv)) {\n    fitted_folds[[i]] &lt;-\n      leaps::regsubsets(x, data = vfold_cv$analysis_df[[i]], nvmax = n_predictors, ...)\n    names(fitted_folds) &lt;- \n      sprintf(paste0(\"Fold%0\", nchar(nrow(vfold_cv)), \"d\"), 1:nrow(vfold_cv))\n  }\n  \n  params_df &lt;- purrr::map2_dfr(\n    .x = fitted_folds,\n    .y = vfold_cv$assess_df,\n    # Compute multi-models summary at each folds\n    ~broom::glance(.x, newdata = .y), \n    .id = \"id\"\n    ) %&gt;% \n    dplyr::select(id, n_predictors, MSE, r.squared)\n  \n  if(return_folds) return(params_df)\n  \n  params_df %&gt;% \n    dplyr::group_by(n_predictors) %&gt;% \n    dplyr::summarise(across(MSE:r.squared, mean, .names = \"{.col}_cv\"))\n\n}\n\nregsubsets_cv_glance(Salary ~ ., Hitters_folds, F) \n\n\n# A tibble: 19 × 3\n   n_predictors  MSE_cv r.squared_cv\n          &lt;int&gt;   &lt;dbl&gt;        &lt;dbl&gt;\n 1            1 149173.        0.326\n 2            2 127140.        0.428\n 3            3 138989.        0.461\n 4            4 142237.        0.484\n 5            5 133685.        0.502\n 6            6 123857.        0.517\n 7            7 130839.        0.525\n 8            8 114532.        0.535\n 9            9 117330.        0.541\n10           10 118435.        0.546\n11           11 117144.        0.549\n12           12 115963.        0.550\n13           13 117636.        0.551\n14           14 117204.        0.552\n15           15 118077.        0.552\n16           16 118673.        0.553\n17           17 118779.        0.553\n18           18 118887.        0.553\n19           19 118564.        0.553"
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html#compute-cross-validation-estimates",
    "href": "posts/2023-09-27_lm-subset-select/index.html#compute-cross-validation-estimates",
    "title": "Linear Model Subset Selection",
    "section": "Compute Cross-Validation Estimates",
    "text": "Compute Cross-Validation Estimates\nMSE_cv is a mean squared error at each predictor subsets; each MSE_cv is averaged over 10 held-out sets.\n\n\nCode\nHitters_cv_fitted &lt;- regsubsets_cv_glance(Salary ~ ., Hitters_folds) \n\nHitters_cv_fitted\n\n\n# A tibble: 19 × 3\n   n_predictors  MSE_cv r.squared_cv\n          &lt;int&gt;   &lt;dbl&gt;        &lt;dbl&gt;\n 1            1 149173.        0.326\n 2            2 127140.        0.428\n 3            3 138989.        0.461\n 4            4 142237.        0.484\n 5            5 133685.        0.502\n 6            6 123857.        0.517\n 7            7 130839.        0.525\n 8            8 114532.        0.535\n 9            9 117330.        0.541\n10           10 118435.        0.546\n11           11 117144.        0.549\n12           12 115963.        0.550\n13           13 117636.        0.551\n14           14 117204.        0.552\n15           15 118077.        0.552\n16           16 118673.        0.553\n17           17 118779.        0.553\n18           18 118887.        0.553\n19           19 118564.        0.553"
  },
  {
    "objectID": "posts/2023-09-27_lm-subset-select/index.html#plotting-cross-validation-estimates",
    "href": "posts/2023-09-27_lm-subset-select/index.html#plotting-cross-validation-estimates",
    "title": "Linear Model Subset Selection",
    "section": "Plotting Cross-Validation Estimates",
    "text": "Plotting Cross-Validation Estimates\nThe Final helper functions, regsubsets_cv_plot(), is for plotting 10-fold Cross-Validation MSE at each number of predictors.\n\n\nCode\nregsubsets_cv_plot &lt;- function(df_glanced, \n                               res = c(\"MSE_cv\",\"r.squared_cv\")\n                          ) {\n  \n  res &lt;- match.arg(res)\n  res_sym &lt;- dplyr::ensym(res)\n  \n  ### Find X & Y-Coordinate of the best model \n  fun &lt;- if(res %in% c(\"MSE_cv\")) min else max\n  \n  best_y &lt;- fun(df_glanced[[res]])\n  best_x &lt;- df_glanced %&gt;%\n      dplyr::filter(!!res_sym == fun(!!res_sym)) %&gt;% dplyr::pull(n_predictors)\n\n  direction_col &lt;- ifelse(res %in% c(\"MSE_cv\"), -1, 1)\n  \n  # Plot\n  df_glanced %&gt;%\n    ggplot2::ggplot(ggplot2::aes(n_predictors, !!res_sym, color = !!res_sym)) +\n    ggplot2::geom_point(show.legend = F) +\n    ggplot2::geom_line(show.legend = F) +\n    ggplot2::scale_color_viridis_c(option = \"plasma\", end = 0.8,\n                                   direction = direction_col) +\n    ggplot2::annotate(\"point\", x = best_x, y = best_y, shape = 4, size = 5, stroke = 0.5)+\n    ggplot2::labs(x = \"Number of Predictors\")\n}\n\n\n\n\nCode\nregsubsets_cv_plot(Hitters_cv_fitted, \"MSE_cv\") +\n  labs(title = \"Best Subset Selection by 10-Fold Cross-Validation\",\n       y = TeX(\"MSE_{10-fold-CV}\")\n       )"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html",
    "href": "posts/2022-05-04_logreg-default/index.html",
    "title": "Predicting Credit Card Default Status",
    "section": "",
    "text": "My motivation and code I used in here is an adaptation from Dr.Julia Silage’s blog bird-baths. I’ve applied the similar modeling process to Default dataset from {ISLR} package [1].\nThe goal is to build logistic regression model to predict default status."
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#plot-relationship",
    "href": "posts/2022-05-04_logreg-default/index.html#plot-relationship",
    "title": "Predicting Credit Card Default Status",
    "section": "Plot Relationship",
    "text": "Plot Relationship\nI will explore the relationship between default and other variables (income, balace, student). Let’s make some plots!\n\n\nCode\nDefault %&gt;% \n  ggplot(aes(balance, income, color = default)) + \n  geom_point(alpha = 0.4) +\n  scale_color_brewer(palette = \"Set1\", direction = -1) +\n  labs(title = \"Default status by income and balance\") \n\n\n\n\n\nBy visual inspection, balance looks like a better predictor for default than income.\n\n\nCode\np1 &lt;- Default %&gt;% \n  ggplot(aes(balance, default, fill = student)) +\n  geom_boxplot(alpha = 0.8) +\n  scale_fill_brewer(palette = \"Dark2\") +\n  labs(title = \"Distribution of default\",\n       subtitle = \"by balance and student status\",\n       caption = \"Data from ISLR package\") \n  \np1 \n\n\n\n\n\nThis plot shows that balance and student seem to be a decent predictor of default."
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#split-data",
    "href": "posts/2022-05-04_logreg-default/index.html#split-data",
    "title": "Predicting Credit Card Default Status",
    "section": "Split Data",
    "text": "Split Data\nFirst, we need to spending data budgets in 2 portions: training and testing data.\n\n\nCode\nset.seed(123)\n# Split to Test and Train\nDefault_split &lt;- initial_split(Default, strata = default)\n\nDefault_train &lt;- training(Default_split) # 75% to traning data\nDefault_test &lt;- testing(Default_split) # 25% to test data\n\nDefault_split\n\n\n&lt;Analysis/Assess/Total&gt;\n&lt;7500/2500/10000&gt;"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#resampling-method",
    "href": "posts/2022-05-04_logreg-default/index.html#resampling-method",
    "title": "Predicting Credit Card Default Status",
    "section": "Resampling Method",
    "text": "Resampling Method\nI will use 10-Fold Cross-Validation to resample the training data.\n\n\nCode\nset.seed(234)\n\nDefault_folds &lt;- vfold_cv(Default_train, v = 10, strata = default)\nDefault_folds \n\n\n#  10-fold cross-validation using stratification \n# A tibble: 10 × 2\n   splits             id    \n   &lt;list&gt;             &lt;chr&gt; \n 1 &lt;split [6750/750]&gt; Fold01\n 2 &lt;split [6750/750]&gt; Fold02\n 3 &lt;split [6750/750]&gt; Fold03\n 4 &lt;split [6750/750]&gt; Fold04\n 5 &lt;split [6750/750]&gt; Fold05\n 6 &lt;split [6750/750]&gt; Fold06\n 7 &lt;split [6750/750]&gt; Fold07\n 8 &lt;split [6750/750]&gt; Fold08\n 9 &lt;split [6750/750]&gt; Fold09\n10 &lt;split [6750/750]&gt; Fold10\n\n\nNote that I use strata = default because the frequency of each class is quite difference.\n\n\nCode\nDefault %&gt;% count(default)\n\n\n  default    n\n1      No 9667\n2     Yes  333\n\n\nFor each folds, 6750 rows will spend on fitting models and 750 spend on analysis of model performance:\n\n\nCode\nDefault_folds$splits[[1]] \n\n\n&lt;Analysis/Assess/Total&gt;\n&lt;6750/750/7500&gt;"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#specification",
    "href": "posts/2022-05-04_logreg-default/index.html#specification",
    "title": "Predicting Credit Card Default Status",
    "section": "Specification",
    "text": "Specification\n\nModel Specification\n\n\nCode\nglm_spec &lt;- logistic_reg()\nglm_spec\n\n\nLogistic Regression Model Specification (classification)\n\nComputational engine: glm \n\n\n\n\nFeature Engineering Specification\n\n\nCode\nrec_basic &lt;- recipe(default ~ ., data = Default) %&gt;% \n  step_dummy(all_nominal_predictors())\n\nsummary(rec_basic)\n\n\n# A tibble: 4 × 4\n  variable type    role      source  \n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   \n1 student  nominal predictor original\n2 balance  numeric predictor original\n3 income   numeric predictor original\n4 default  nominal outcome   original\n\n\nPreview of engineered training data\nYou can see that student was replaced by student_Yes with 0-1 encoding. What does it mean?\n\n\nCode\nrec_basic %&gt;% \n  prep(log_change = T) %&gt;% \n  bake(new_data = Default_train)\n\n\nstep_dummy (dummy_72FQt): \n new (1): student_Yes\n removed (1): student\n\n\n# A tibble: 7,500 × 4\n   balance income default student_Yes\n     &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;         &lt;dbl&gt;\n 1    730. 44362. No                0\n 2    817. 12106. No                1\n 3   1074. 31767. No                0\n 4    529. 35704. No                0\n 5    786. 38463. No                0\n 6    826. 24905. No                0\n 7    809. 17600. No                1\n 8   1161. 37469. No                0\n 9      0  29275. No                0\n10      0  21871. No                1\n# … with 7,490 more rows\n\n\nFrom contrast() function we can see the dummy encoding of the student (factor) variable: No = 0, Yes = 1.\n\n\nCode\ncontrasts(Default$student)\n\n\n    Yes\nNo    0\nYes   1\n\n\n\n\nWorkflow\nworkflow() will bundle blueprint of feature engineering and model specification together.\n\n\nCode\nwf_basic &lt;- workflow(rec_basic, glm_spec)\nwf_basic\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: logistic_reg()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n1 Recipe Step\n\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nLogistic Regression Model Specification (classification)\n\nComputational engine: glm"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#fit-model-to-resampled-data",
    "href": "posts/2022-05-04_logreg-default/index.html#fit-model-to-resampled-data",
    "title": "Predicting Credit Card Default Status",
    "section": "Fit Model to Resampled Data",
    "text": "Fit Model to Resampled Data\n\n\nCode\ndoParallel::registerDoParallel()\n\nctrl_preds &lt;- control_resamples(save_pred = TRUE)\n## Fit\nrs_basic &lt;- fit_resamples(wf_basic, resamples =  Default_folds, control = ctrl_preds)\n\n\nWarning: package 'rlang' was built under R version 4.1.2\n\n\nWarning: package 'vctrs' was built under R version 4.1.2\n\n\nCode\nhead(rs_basic)\n\n\n# A tibble: 6 × 5\n  splits             id     .metrics         .notes           .predictions      \n  &lt;list&gt;             &lt;chr&gt;  &lt;list&gt;           &lt;list&gt;           &lt;list&gt;            \n1 &lt;split [6750/750]&gt; Fold01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt; &lt;tibble [750 × 6]&gt;\n2 &lt;split [6750/750]&gt; Fold02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt; &lt;tibble [750 × 6]&gt;\n3 &lt;split [6750/750]&gt; Fold03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt; &lt;tibble [750 × 6]&gt;\n4 &lt;split [6750/750]&gt; Fold04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt; &lt;tibble [750 × 6]&gt;\n5 &lt;split [6750/750]&gt; Fold05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt; &lt;tibble [750 × 6]&gt;\n6 &lt;split [6750/750]&gt; Fold06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt; &lt;tibble [750 × 6]&gt;"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#roc-curve",
    "href": "posts/2022-05-04_logreg-default/index.html#roc-curve",
    "title": "Predicting Credit Card Default Status",
    "section": "ROC Curve",
    "text": "ROC Curve\nFrom ROC curve we can see that it has pretty good upper-left bulging curve.\n\n\nCode\naugment(rs_basic) %&gt;% \n  roc_curve(truth = default, .pred_No) %&gt;% \n  autoplot()\n\n\n\n\n\nThis would result in AUC (area under the ROC curve) and accuracy close to 1.\n\n\nCode\ncollect_metrics(rs_basic)\n\n\n# A tibble: 2 × 6\n  .metric  .estimator  mean     n std_err .config             \n  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               \n1 accuracy binary     0.974    10 0.00194 Preprocessor1_Model1\n2 roc_auc  binary     0.953    10 0.00461 Preprocessor1_Model1"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#roc-curve-of-the-improved-model",
    "href": "posts/2022-05-04_logreg-default/index.html#roc-curve-of-the-improved-model",
    "title": "Predicting Credit Card Default Status",
    "section": "ROC curve of the improved model",
    "text": "ROC curve of the improved model\nThis plot show comparison of ROC curves of the 2 logistic regression models.\n\nRed line shows model that use all predictors: student, balance and income.\nBlue line shows model that use 2 predictor: student and balance.\n\n\n\nCode\nroc_df %&gt;% \n  ggplot(aes(1-specificity, sensitivity, color = Predictors)) +\n  geom_line(size = 1, alpha = 0.6, linetype = \"dashed\") +\n  geom_abline(intercept = 0, slope = 1, linetype = \"dotted\")\n\n\n\n\n\n\n\nCode\nrs_ls %&gt;% \n  map_dfr(\n    collect_metrics, .id = \"Features\"\n  )\n\n\n# A tibble: 4 × 7\n  Features          .metric  .estimator  mean     n std_err .config             \n  &lt;chr&gt;             &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               \n1 All Predictors    accuracy binary     0.974    10 0.00194 Preprocessor1_Model1\n2 All Predictors    roc_auc  binary     0.953    10 0.00461 Preprocessor1_Model1\n3 student + balance accuracy binary     0.974    10 0.00194 Preprocessor1_Model1\n4 student + balance roc_auc  binary     0.953    10 0.00461 Preprocessor1_Model1\n\n\nYou can see that a simpler model result in a similar (or may be slightly improved) AUC. So it’s reasonable to prefer it over more complicated model."
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#fit-to-training-data",
    "href": "posts/2022-05-04_logreg-default/index.html#fit-to-training-data",
    "title": "Predicting Credit Card Default Status",
    "section": "Fit to Training data",
    "text": "Fit to Training data\nFirst, fit the model to training data.\n\n\nCode\nDefault_fit &lt;- fit(wf_simple, Default_train)\nDefault_fit\n\n\n══ Workflow [trained] ══════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: logistic_reg()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n1 Recipe Step\n\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\n\nCall:  stats::glm(formula = ..y ~ ., family = stats::binomial, data = data)\n\nCoefficients:\n(Intercept)      balance  student_Yes  \n  -10.85340      0.00578     -0.71313  \n\nDegrees of Freedom: 7499 Total (i.e. Null);  7497 Residual\nNull Deviance:      2158 \nResidual Deviance: 1139     AIC: 1145"
  },
  {
    "objectID": "posts/2022-05-04_logreg-default/index.html#use-testing-data-to-predict",
    "href": "posts/2022-05-04_logreg-default/index.html#use-testing-data-to-predict",
    "title": "Predicting Credit Card Default Status",
    "section": "Use Testing data to Predict",
    "text": "Use Testing data to Predict\nThen, use test data to predict default.\n\n\nCode\nDefault_pred &lt;- \n  augment(Default_fit, Default_test) %&gt;% \n  bind_cols(\n    predict(Default_fit, Default_test, type = \"conf_int\")\n  )\n\n\n\n\nCode\nlibrary(latex2exp)\np2 &lt;- Default_pred %&gt;% \n  ggplot(aes(balance, .pred_Yes, fill = student)) +\n  geom_line(aes(color = student)) +\n  geom_ribbon(aes(ymin = .pred_lower_Yes, ymax = .pred_upper_Yes),\n              alpha = 0.3) +\n  scale_fill_brewer(palette = \"Dark2\") +\n  scale_color_brewer(palette = \"Dark2\") +\n  labs(y = TeX(\"$\\\\hat{p}(default)$\"),\n       caption = \"Area indicate 95% CI of the estimated probability\") +\n  labs(title = \"Predicted probability of default\", \n       subtitle = \"by logistic regression with 2 predictors\")\n\np2 \n\n\n\n\n\nThis plot show estimated probability of default if we know the values of predictors: student and balance by using logistic regression model fitted on training data. The prediction was made by plugging test data to the model."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Lightbridge",
    "section": "",
    "text": "Welcome !\n\n  \n    \n\n    \n  \n    \n     Email\n  \n  \n    \n     Github\n  \n  \n    \n     Website\n  \n\n  \n  \nHi 👋, I am a medical doctor who gains interest in software developing and data science. I love computer software and developing tools for others and myself to use in real life and also for fun.\nMy first programming language is R, and now it is my favorite tool to analyse data, build R-package, and build cool shiny application."
  }
]